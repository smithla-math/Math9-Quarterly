
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lectures 28-30 &#8212; Math 9 Fall 2025</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/lec28_30_FA_25';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python Homework #3" href="../homework/pyhw3.html" />
    <link rel="prev" title="Lectures 25-27" href="lec25_27_FA_25.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ash-vapor4.png" class="logo__image only-light" alt="Math 9 Fall 2025 - Home"/>
    <img src="../_static/ash-vapor4.png" class="logo__image only-dark pst-js-only" alt="Math 9 Fall 2025 - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    UC Irvine Math 9, Fall 2025
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lec17_19_FA_25.html">Lectures 17-19</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/pyhw1.html">Python Homework #1</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lec20_22_FA_25.html">Lectures 20-22</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec22_FA_25_plotting.html">Lecture 22 part 2: Plotting in Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lec23_25_FA_25.html">Lectures 23-25</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/pyhw2.html">Python Homework #2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lec25_27_FA_25.html">Lectures 25-27</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 10</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lectures 28-30</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/pyhw3.html">Python Homework #3</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Final Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../final/final-project.html">Final Project Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/Project_Euler.html">Final Project Option: Project Euler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/Data_Science.html">Final Project Option: Data Analysis and Data Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/Algorithmic_Art.html">Final Project Option: Algorithmic Art</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="FA24_lec23_24.html">Lectures 23-24 from FA24</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/pyhw4_FA24.html">Python HW #4 from FA24</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/smithla-math/Math9-Quarterly" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/smithla-math/Math9-Quarterly/issues/new?title=Issue%20on%20page%20%2Flectures/lec28_30_FA_25.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/lec28_30_FA_25.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lectures 28-30</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-newton-s-method">Analyzing Newton‚Äôs Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newton-s-method-vs-bisect-method-timing-and-tradeoffs">Newton‚Äôs Method vs. Bisect Method: Timing and Tradeoffs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-processing">Image Processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-an-image">Opening an image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-arrays-and-images">NumPy Arrays and Images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#blending-images">Blending Images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#averaging-images-in-2d-video-game-graphics-transparent-water">Averaging images in 2D video game graphics: Transparent water</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-colors">Setting Colors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-an-image-from-scratch">Making an image from scratch</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#swapping-color-channels">Swapping color channels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#invert-colors">Invert Colors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#threshold-filter">Threshold filter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brighten-darken-image">Brighten/Darken Image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grayscale-filter">Grayscale Filter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-better-algorithm-for-grayscale">A better algorithm for grayscale</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sepia-filter">Sepia Filter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient-filter">Gradient filter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#duotone-filter-generate-a-two-color-gradient-and-use-it-to-recolor-your-image">Duotone filter - Generate a two-color gradient and use it to recolor your image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-gradients-and-other-color-replacement">Other gradients, and other color replacement</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#white-noise-colorful-noise">White Noise, Colorful Noise</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-blending-modes">More blending modes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lighten-only">Lighten Only:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#darken-only">Darken Only:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#absolute-difference">(Absolute) Difference:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#color-dodge">Color Dodge:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#color-burn">Color Burn:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combine-gradient-filters-with-blend-modes">Combine gradient filters with blend modes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-photo-manipulation-effects">More photo manipulation effects</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lectures-28-30">
<h1>Lectures 28-30<a class="headerlink" href="#lectures-28-30" title="Link to this heading">#</a></h1>
<p><strong>Today:</strong></p>
<ul class="simple">
<li><p>Finish Newton‚Äôs Method material</p></li>
<li><p>Start Python Unit 4 (image processing) üéâ</p></li>
</ul>
<p><strong>Future:</strong></p>
<ul class="simple">
<li><p>Next week is finals week. There is no final, or meeting time for next week ‚Äì there will be office hours.</p></li>
</ul>
<section id="analyzing-newton-s-method">
<h2>Analyzing Newton‚Äôs Method<a class="headerlink" href="#analyzing-newton-s-method" title="Link to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(f(x) = x^3 - 2x + 2\)</span>. For each value of <span class="math notranslate nohighlight">\(z\)</span> in <code class="docutils literal notranslate"><span class="pre">np.linspace(-2,2,1000)</span></code>, apply Newton‚Äôs method 7 times, and call the result <code class="docutils literal notranslate"><span class="pre">results</span></code>. For how many of these 1000 values do we have <span class="math notranslate nohighlight">\(-0.001 &lt; f(\text{results}) &lt; 0.001\)</span>?</p>
<p>Recall that <span class="math notranslate nohighlight">\(f(\text{results})=0 \)</span> if we end up with the true root, and <span class="math notranslate nohighlight">\(f(\text{results}) \approx 0 \)</span> if the result is almost a root.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span>
<span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">newt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Idea:</strong> Each row of <code class="docutils literal notranslate"><span class="pre">arr</span></code> will be the result of applying Newton‚Äôs method 7 times to a single point in <code class="docutils literal notranslate"><span class="pre">np.linspace(-2,2,1000)</span></code>. ‚ÄúA row for each point‚Äù</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1">#instead of one initial guess, we&#39;ll try every point on the interval [-2, 2].</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">),</span><span class="n">reps</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>  <span class="c1">#columns are the iterations of newton&#39;s method, the rows represent each initial value (of which there are 1000)</span>
<span class="n">arr</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>  <span class="c1">#same except for using the [:,0] instead of [0]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
    <span class="n">arr</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">newt</span><span class="p">(</span><span class="n">arr</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1">#last column holds the results, the final x-values from Newton&#39;s method</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1a09332f4edcf9f7e543da800c282d3c72d775e61b9596bd33dfc9532ba2d262.png" src="../_images/1a09332f4edcf9f7e543da800c282d3c72d775e61b9596bd33dfc9532ba2d262.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_bool</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">results</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.001</span>   <span class="c1">#check the absolute value of the y-values from Newton&#39;s method</span>
</pre></div>
</div>
</div>
</div>
<p>The length makes sense, because we have 1000 points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_bool</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1000,)
</pre></div>
</div>
</div>
</div>
<p>Out of the 1000 input points, we see that 327 of them lead to a good estimate for a zero of <span class="math notranslate nohighlight">\(f\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_bool</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>327
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs plot these points and see where they live. There‚Äôs a mistake here, we need the size of <code class="docutils literal notranslate"><span class="pre">pts</span></code> to match the size of the <span class="math notranslate nohighlight">\(y\)</span>-values. There‚Äôs a pretty easy fix for this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">good_bool</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">pts</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">good_bool</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">)</span>

<span class="nn">File C:\ProgramData\anaconda3\Lib\site-packages\matplotlib\axes\_axes.py:1779,</span> in <span class="ni">Axes.plot</span><span class="nt">(self, scalex, scaley, data, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1536</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1537</span><span class="sd"> Plot y versus x as lines and/or markers.</span>
<span class="g g-Whitespace">   </span><span class="mi">1538</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1776</span><span class="sd"> (``&#39;green&#39;``) or hex strings (``&#39;#008000&#39;``).</span>
<span class="g g-Whitespace">   </span><span class="mi">1777</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1778</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">normalize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1779</span> <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)]</span>
<span class="g g-Whitespace">   </span><span class="mi">1780</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1781</span>     <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="nn">File C:\ProgramData\anaconda3\Lib\site-packages\matplotlib\axes\_base.py:296,</span> in <span class="ni">_process_plot_var_args.__call__</span><span class="nt">(self, axes, data, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">294</span>     <span class="n">this</span> <span class="o">+=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">295</span>     <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="ne">--&gt; </span><span class="mi">296</span> <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_args</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span>     <span class="n">axes</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">ambiguous_fmt_datakey</span><span class="o">=</span><span class="n">ambiguous_fmt_datakey</span><span class="p">)</span>

<span class="nn">File C:\ProgramData\anaconda3\Lib\site-packages\matplotlib\axes\_base.py:486,</span> in <span class="ni">_process_plot_var_args._plot_args</span><span class="nt">(self, axes, tup, kwargs, return_kwargs, ambiguous_fmt_datakey)</span>
<span class="g g-Whitespace">    </span><span class="mi">483</span>     <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">update_units</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">485</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">486</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x and y must have same first dimension, but &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">487</span>                      <span class="sa">f</span><span class="s2">&quot;have shapes </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">488</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">y</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">489</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x and y can be no greater than 2D, but have &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">490</span>                      <span class="sa">f</span><span class="s2">&quot;shapes </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="ne">ValueError</span>: x and y must have same first dimension, but have shapes (327,) and (1,)
</pre></div>
</div>
<img alt="../_images/1a09332f4edcf9f7e543da800c282d3c72d775e61b9596bd33dfc9532ba2d262.png" src="../_images/1a09332f4edcf9f7e543da800c282d3c72d775e61b9596bd33dfc9532ba2d262.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">good_bool</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)),</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6b6d217d8ce374b9cc4fb340018f8499d216c9928f214971d8edced1833a7ac0.png" src="../_images/6b6d217d8ce374b9cc4fb340018f8499d216c9928f214971d8edced1833a7ac0.png" />
</div>
</div>
<p>Let‚Äôs update this plot to now have the bad points in red.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">good_bool</span><span class="p">]</span>
<span class="n">pts2</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="o">~</span><span class="n">good_bool</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)),</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pts2</span><span class="p">)),</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">);</span> <span class="c1">#smaller markers so the scattered black markers still show</span>
<span class="c1">#alpha determines the transparency of a point. alpha = 0 is totally invisible, and alpha = 1 is totally opaque.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/45f556b5f6ac3f2ac44b0d33487d44463312f15045c4a7b44ea99974ee1d7a98.png" src="../_images/45f556b5f6ac3f2ac44b0d33487d44463312f15045c4a7b44ea99974ee1d7a98.png" />
</div>
</div>
</section>
<section id="newton-s-method-vs-bisect-method-timing-and-tradeoffs">
<h2>Newton‚Äôs Method vs. Bisect Method: Timing and Tradeoffs<a class="headerlink" href="#newton-s-method-vs-bisect-method-timing-and-tradeoffs" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import numpy as np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">tol</span><span class="p">):</span>  <span class="c1">#Almost the same code as in Matlab.</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">root</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span> <span class="c1">#when |f(root)| is large, we are far away from the x-axis.</span>
        <span class="n">root</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1">#product is negative if and only if the individual values have opposite signs.</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">root</span> <span class="c1">#root is between x0 and root, so replace x1 with root</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">root</span>
    <span class="k">return</span> <span class="n">root</span>

<span class="k">def</span> <span class="nf">newt_while</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="p">):</span>   <span class="c1">#modified to only take the very end result, and to keep running until we are a certain distance away from the x-axis.</span>
    <span class="n">newt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">x0</span>
    
    <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">root</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span> <span class="c1">#when |f(root)| is large, we are far away from the x-axis.</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">newt</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">root</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span>
<span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>
<span class="n">xf</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-12</span>   <span class="c1">#Try at 1e-3, 1e-8, and 1e-12</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">xf</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>65 Œºs ¬± 2.42 Œºs per loop (mean ¬± std. dev. of 7 runs, 10,000 loops each)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">newt_while</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.85 Œºs ¬± 608 ns per loop (mean ¬± std. dev. of 7 runs, 100,000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Conclusion: Both methods are very efficient, even though Newton‚Äôs method is quicker. Newton‚Äôs method has a larger speed advantage for higher tolerances</p>
</section>
<hr class="docutils" />
<section id="image-processing">
<h2>Image Processing<a class="headerlink" href="#image-processing" title="Link to this heading">#</a></h2>
<p>This unit will require you to import Pillow/PIL. It should already be installed through Anaconda, so all we need are the first import lines below</p>
<p>Why are we going through image processing? The point is not that image processing is super import to Math 9/numerical analysis, but that it gives us a really good opportunity to work with and visualize NumPy arrays.</p>
<section id="opening-an-image">
<h3>Opening an image<a class="headerlink" href="#opening-an-image" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1">#operating system, used for accessing files on the computer.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</div>
</div>
<p>I‚Äôm first going to show you how to open an image that‚Äôs in the folder we‚Äôre currently working in. When you open Jupyter notebook, the image should show up in the Home Page. If it‚Äôs not there, you won‚Äôt be able to open it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;ash-lake.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" src="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" />
</div>
</div>
<p>Maybe you‚Äôre not sure which folder you‚Äôre working in. Here‚Äôs how we can check. I‚Äôm going to remove the output when I post these online, just because I don‚Äôt want my file paths on the internet :)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="c1">#current working directory</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;C:\\Users\\lukea\\Documents\\GitHub\\Math9-Quarterly\\lectures&#39;
</pre></div>
</div>
</div>
</div>
<p>This is how I can list everything in my current folder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;.ipynb_checkpoints&#39;,
 &#39;ash-lake-crop.png&#39;,
 &#39;ash-lake.png&#39;,
 &#39;cavelight.png&#39;,
 &#39;chaosspiel.jpg&#39;,
 &#39;Custom gradient.png&#39;,
 &#39;dryingtemple.png&#39;,
 &#39;extra_art.ipynb&#39;,
 &#39;FA24_lec23_24.ipynb&#39;,
 &#39;images&#39;,
 &#39;lec17_19_FA_25.ipynb&#39;,
 &#39;lec20_22_FA_25.ipynb&#39;,
 &#39;lec22_FA_25_plotting.ipynb&#39;,
 &#39;lec23_25_FA_25.ipynb&#39;,
 &#39;lec25_27_FA_25.ipynb&#39;,
 &#39;lec28_30_FA_25.ipynb&#39;]
</pre></div>
</div>
</div>
</div>
<p>For organization, I almost always prefer to have a separate folder for images. I usually call it <code class="docutils literal notranslate"><span class="pre">images</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">)</span> <span class="c1">#name of my folder</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;.ipynb_checkpoints&#39;,
 &#39;12.jpg&#39;,
 &#39;13.jpg&#39;,
 &#39;130942.png&#39;,
 &#39;130943.png&#39;,
 &#39;132766.png&#39;,
 &#39;132767.png&#39;,
 &#39;14.jpg&#39;,
 &#39;15.jpg&#39;,
 &#39;16.jpg&#39;,
 &#39;17.jpg&#39;,
 &#39;18.jpg&#39;,
 &#39;19.jpg&#39;,
 &#39;20.jpg&#39;,
 &#39;21.jpg&#39;,
 &#39;22.jpg&#39;,
 &#39;23.jpg&#39;,
 &#39;24.jpg&#39;,
 &#39;25.jpg&#39;,
 &#39;26.jpg&#39;,
 &#39;27.jpg&#39;,
 &#39;anor-londo.png&#39;,
 &#39;b9db0815877977.5635a677be8bb.jpg&#39;,
 &#39;Cloud.png&#39;,
 &#39;magus.webp&#39;,
 &#39;MW-place-Ghostgate.jpg&#39;,
 &#39;record-of-lodoss-war-elwa1.webp&#39;,
 &#39;Red_room.jpeg&#39;,
 &#39;Sheogorath.jpg&#39;]
</pre></div>
</div>
</div>
</div>
<p>Say I wanted to open one of the images in my <code class="docutils literal notranslate"><span class="pre">images</span></code> folder. The following will cause an error, since the jpg is not in my current folder, but a subfolder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Red_room.jpeg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">23</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Red_room.jpeg&#39;</span><span class="p">)</span>

<span class="nn">File C:\ProgramData\anaconda3\Lib\site-packages\PIL\Image.py:3431,</span> in <span class="ni">open</span><span class="nt">(fp, mode, formats)</span>
<span class="g g-Whitespace">   </span><span class="mi">3428</span>     <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fspath</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">3430</span> <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3431</span>     <span class="n">fp</span> <span class="o">=</span> <span class="n">builtins</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3432</span>     <span class="n">exclusive_fp</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">   </span><span class="mi">3433</span> <span class="k">else</span><span class="p">:</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;C:\\Users\\lukea\\Documents\\GitHub\\Math9-Quarterly\\lectures\\Red_room.jpeg&#39;
</pre></div>
</div>
</div>
</div>
<p>To navigate to the <code class="docutils literal notranslate"><span class="pre">images</span></code> folder, I could type out the path name directly, but this is going to be different for different operating systems. The way I‚Äôm going to show you is maybe cumbersome, but has the benefit of being able to work for any operating system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span><span class="s1">&#39;Red_room.jpeg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;images\\Red_room.jpeg&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9aa7041886dbe8028ad310758306f0c6774ed44f2a54a991ff1c9fa7cd4ab760.png" src="../_images/9aa7041886dbe8028ad310758306f0c6774ed44f2a54a991ff1c9fa7cd4ab760.png" />
</div>
</div>
<p>How could I get all of the jpgs in a folder?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;.ipynb_checkpoints&#39;,
 &#39;12.jpg&#39;,
 &#39;13.jpg&#39;,
 &#39;130942.png&#39;,
 &#39;130943.png&#39;,
 &#39;132766.png&#39;,
 &#39;132767.png&#39;,
 &#39;14.jpg&#39;,
 &#39;15.jpg&#39;,
 &#39;16.jpg&#39;,
 &#39;17.jpg&#39;,
 &#39;18.jpg&#39;,
 &#39;19.jpg&#39;,
 &#39;20.jpg&#39;,
 &#39;21.jpg&#39;,
 &#39;22.jpg&#39;,
 &#39;23.jpg&#39;,
 &#39;24.jpg&#39;,
 &#39;25.jpg&#39;,
 &#39;26.jpg&#39;,
 &#39;27.jpg&#39;,
 &#39;anor-londo.png&#39;,
 &#39;b9db0815877977.5635a677be8bb.jpg&#39;,
 &#39;Cloud.png&#39;,
 &#39;magus.webp&#39;,
 &#39;MW-place-Ghostgate.jpg&#39;,
 &#39;record-of-lodoss-war-elwa1.webp&#39;,
 &#39;Red_room.jpeg&#39;,
 &#39;Sheogorath.jpg&#39;]
</pre></div>
</div>
</div>
</div>
<p>Less pythonic way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">&quot;jpg&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;12.jpg&#39;,
 &#39;13.jpg&#39;,
 &#39;14.jpg&#39;,
 &#39;15.jpg&#39;,
 &#39;16.jpg&#39;,
 &#39;17.jpg&#39;,
 &#39;18.jpg&#39;,
 &#39;19.jpg&#39;,
 &#39;20.jpg&#39;,
 &#39;21.jpg&#39;,
 &#39;22.jpg&#39;,
 &#39;23.jpg&#39;,
 &#39;24.jpg&#39;,
 &#39;25.jpg&#39;,
 &#39;26.jpg&#39;,
 &#39;27.jpg&#39;,
 &#39;b9db0815877977.5635a677be8bb.jpg&#39;,
 &#39;MW-place-Ghostgate.jpg&#39;,
 &#39;Sheogorath.jpg&#39;]
</pre></div>
</div>
</div>
</div>
<p>More pythonic way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;130942.png&#39;,
 &#39;130943.png&#39;,
 &#39;132766.png&#39;,
 &#39;132767.png&#39;,
 &#39;anor-londo.png&#39;,
 &#39;Cloud.png&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;webp&quot;</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;magus.webp&#39;, &#39;record-of-lodoss-war-elwa1.webp&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>list
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;webp&quot;</span><span class="p">):</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
        <span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d2ff229eac484c7a0f7cac090a13d904750f816fe242acc73b15733f0e0f9276.png" src="../_images/d2ff229eac484c7a0f7cac090a13d904750f816fe242acc73b15733f0e0f9276.png" />
<img alt="../_images/0b233d62fa3f66e47921f10a86ccfc703ad7a2fb1f85f46c38c019d51bb9df18.png" src="../_images/0b233d62fa3f66e47921f10a86ccfc703ad7a2fb1f85f46c38c019d51bb9df18.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;jpg&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
        <span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3a858f0a86b20d59c1d9906dd8b6fa91a4d1ca2bb7e9feba7d291921f0f28e1c.png" src="../_images/3a858f0a86b20d59c1d9906dd8b6fa91a4d1ca2bb7e9feba7d291921f0f28e1c.png" />
<img alt="../_images/fa4c43b09b3a190912d6441310f4173bb4128eb1dd68a3bd928e8c9c70c96cc5.png" src="../_images/fa4c43b09b3a190912d6441310f4173bb4128eb1dd68a3bd928e8c9c70c96cc5.png" />
<img alt="../_images/e0bfb0a0ce5d18815d6eafb97a6211282316cbbecdcbf22b0f387bba0d4f9208.png" src="../_images/e0bfb0a0ce5d18815d6eafb97a6211282316cbbecdcbf22b0f387bba0d4f9208.png" />
</div>
</div>
</section>
<section id="numpy-arrays-and-images">
<h3>NumPy Arrays and Images<a class="headerlink" href="#numpy-arrays-and-images" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;ash-lake.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" src="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PIL.PngImagePlugin.PngImageFile
</pre></div>
</div>
</div>
</div>
<p>We can see this is not a NumPy array‚Ä¶here‚Äôs what we do.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 83, 161, 148],
        [ 83, 161, 148],
        [ 83, 161, 148],
        ...,
        [ 94, 157, 140],
        [ 94, 157, 140],
        [ 94, 157, 140]],

       [[ 83, 161, 148],
        [ 83, 161, 148],
        [ 83, 161, 148],
        ...,
        [ 93, 156, 139],
        [ 93, 156, 139],
        [ 93, 156, 139]],

       [[ 83, 161, 148],
        [ 83, 161, 148],
        [ 83, 161, 148],
        ...,
        [ 93, 156, 139],
        [ 92, 155, 138],
        [ 92, 155, 138]],

       ...,

       [[117, 128, 120],
        [140, 151, 143],
        [152, 163, 155],
        ...,
        [113, 126, 119],
        [117, 130, 123],
        [121, 134, 127]],

       [[128, 139, 131],
        [129, 140, 132],
        [124, 135, 127],
        ...,
        [112, 125, 118],
        [114, 127, 120],
        [116, 129, 122]],

       [[130, 141, 133],
        [118, 129, 121],
        [105, 117, 107],
        ...,
        [119, 132, 125],
        [120, 133, 126],
        [121, 134, 127]]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.ndarray
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(480, 480, 3)
</pre></div>
</div>
</div>
</div>
<p>Think of this as saying we have <span class="math notranslate nohighlight">\(480 \times 480\)</span> pixels, and each pixel has an RGB (Red-Green-Blue) triplet.</p>
<p>Let‚Äôs get the top-left-most pixel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 83, 161, 148], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<p>This is saying we have 83 Red, 161 Green, 148 Blue.</p>
<p>Maybe I wonder what the range of these RGB values is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>255
</pre></div>
</div>
</div>
</div>
<p>All together, there are <span class="math notranslate nohighlight">\(2^8 = 256\)</span> possibilities for each RGB value. This is why we store these as 8-bit integers (notice the <code class="docutils literal notranslate"><span class="pre">dtype=uint8</span></code> in <code class="docutils literal notranslate"><span class="pre">arr</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">arr</span><span class="p">[:,</span><span class="mi">300</span><span class="p">:])</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(480, 180, 3)
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs actually visualize this slice!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" src="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr</span><span class="p">[:,</span><span class="mi">300</span><span class="p">:])</span>   <span class="c1">#Sliced array gives cropped image</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e6f413030d576962eaaf092feb0f613f386837e3ce7cbf32810fd972d3dc9086.png" src="../_images/e6f413030d576962eaaf092feb0f613f386837e3ce7cbf32810fd972d3dc9086.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr</span><span class="p">[:,:</span><span class="mi">100</span><span class="p">])</span>   <span class="c1">#note that the [0,0] pixel is in the upper left corner</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0e5cb5e357502ac05ff5142de9f43799df38d8b9daf47e8d2066883455fb5d95.png" src="../_images/0e5cb5e357502ac05ff5142de9f43799df38d8b9daf47e8d2066883455fb5d95.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_no_mid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">arr</span><span class="p">[:,:</span><span class="mi">100</span><span class="p">],</span><span class="n">arr</span><span class="p">[:,</span><span class="mi">300</span><span class="p">:]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#choose the axis where the array sizes are different.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_no_mid</span><span class="p">)</span>  <span class="c1">#middle of image cropped out</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c39f307ec901f645bb1f9f2c949272003bc6b0a831b9d97b3bad8cac756d810f.png" src="../_images/c39f307ec901f645bb1f9f2c949272003bc6b0a831b9d97b3bad8cac756d810f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_flip</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,:]</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_flip</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d0317c9891e6c2a4ff929daed126fd19fcbada84ee865c11af5cf7c24b2af039.png" src="../_images/d0317c9891e6c2a4ff929daed126fd19fcbada84ee865c11af5cf7c24b2af039.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_squash</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[::</span><span class="mi">2</span><span class="p">,::,:]</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_squash</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7ba9651d69c0e1271145a03c907cfdd7795f253ed801a4e3c3fddd1029a7169a.png" src="../_images/7ba9651d69c0e1271145a03c907cfdd7795f253ed801a4e3c3fddd1029a7169a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span><span class="s1">&#39;Red_room.jpeg&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>images\Red_room.jpeg
</pre></div>
</div>
<img alt="../_images/9aa7041886dbe8028ad310758306f0c6774ed44f2a54a991ff1c9fa7cd4ab760.png" src="../_images/9aa7041886dbe8028ad310758306f0c6774ed44f2a54a991ff1c9fa7cd4ab760.png" />
</div>
</div>
</section>
<section id="blending-images">
<h3>Blending Images<a class="headerlink" href="#blending-images" title="Link to this heading">#</a></h3>
<p>Goal: Crop the image of the lamp in the Red Room, and put it in Ash Lake.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_red</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="n">arr_red</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 80,  25,  31],
        [ 76,  21,  27],
        [ 70,  15,  21],
        ...,
        [148,  52,  63],
        [149,  53,  64],
        [146,  53,  63]],

       [[ 82,  27,  33],
        [ 81,  26,  32],
        [ 79,  24,  30],
        ...,
        [152,  56,  67],
        [152,  56,  67],
        [148,  55,  65]],

       [[ 75,  20,  26],
        [ 79,  24,  30],
        [ 81,  26,  32],
        ...,
        [153,  57,  68],
        [152,  56,  67],
        [146,  53,  63]],

       ...,

       [[175, 143, 122],
        [174, 142, 121],
        [174, 142, 121],
        ...,
        [115, 103, 107],
        [115, 103, 107],
        [115, 103, 107]],

       [[177, 145, 124],
        [175, 143, 122],
        [175, 143, 122],
        ...,
        [114, 102, 106],
        [114, 102, 106],
        [114, 102, 106]],

       [[179, 147, 126],
        [177, 145, 124],
        [176, 144, 123],
        ...,
        [116, 104, 108],
        [116, 104, 108],
        [116, 104, 108]]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_r_crop</span> <span class="o">=</span> <span class="n">arr_red</span><span class="p">[</span><span class="mi">400</span><span class="p">:</span><span class="mi">880</span><span class="p">,</span><span class="mi">260</span><span class="p">:</span><span class="mi">740</span><span class="p">]</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_r_crop</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8b93187afec37c63764f0e68e8a8673bb32b5895f92d64479c9f9ac1e926061a.png" src="../_images/8b93187afec37c63764f0e68e8a8673bb32b5895f92d64479c9f9ac1e926061a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_r_crop</span><span class="o">.</span><span class="n">shape</span>  <span class="c1">#same shape as Ash Lake</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(480, 480, 3)
</pre></div>
</div>
</div>
</div>
<p>We can blend the two images by adding. Each color in each pixel is added together. We have to be careful because if a pixel‚Äôs value goes over 255, or becomes negative, the colors start to look strange.</p>
<p>Technically, each color channel in each pixel is defined as an 8-bit integer (type <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code>). This means the color‚Äôs min is 0 and the max is 255. Any values that leave this range are modded so that they return to this range. However, this affects the colors in a major way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr</span> <span class="o">+</span> <span class="n">arr_r_crop</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/37d30789e7b63abdcbf14e9348b96689c01c2de4058573541d2339d2afd65505.png" src="../_images/37d30789e7b63abdcbf14e9348b96689c01c2de4058573541d2339d2afd65505.png" />
</div>
</div>
<p>It‚Äôs better to take a weighted average of the arrays, to blend images together. This prevents overflow.</p>
<p>Make sure values are integers, PIL is somewhat picky. We must cast our final numbers back to <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code> to avoid decimals in final calculation. Some rounding will occur.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weighted_average</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">weight</span><span class="p">,</span> <span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">weight</span><span class="p">)</span><span class="o">*</span><span class="n">arr1</span> <span class="o">+</span> <span class="n">weight</span><span class="o">*</span><span class="n">arr2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">=</span><span class="mf">0.4</span>
<span class="n">weighted_average</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">arr_r_crop</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d6c1cb2834f7f054ab3e17e64a406807f473178b263575af5cf9a45597e4e1a0.png" src="../_images/d6c1cb2834f7f054ab3e17e64a406807f473178b263575af5cf9a45597e4e1a0.png" />
</div>
</div>
<p>We can also scale this image so that the lamp better matches the bonfire. If we want to scale by 1/2, then the trick is to take every other pixel when we crop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_crop_scale</span> <span class="o">=</span> <span class="n">arr_red</span><span class="p">[:</span><span class="mi">960</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">260</span><span class="p">:</span><span class="mi">690</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r_crop_scale</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">r_crop_scale</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(480, 215, 3)
</pre></div>
</div>
<img alt="../_images/96f388deb385a65292a0f9c6d97cd1603593eb7edf75bfc2c886679b4892935c.png" src="../_images/96f388deb385a65292a0f9c6d97cd1603593eb7edf75bfc2c886679b4892935c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_sc</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">weight</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">arr_sc</span><span class="p">[:,</span> <span class="mi">120</span><span class="p">:</span><span class="mi">335</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">weight</span><span class="p">)</span><span class="o">*</span><span class="n">arr_sc</span><span class="p">[:,</span> <span class="mi">120</span><span class="p">:</span><span class="mi">335</span><span class="p">]</span> <span class="o">+</span> <span class="n">weight</span><span class="o">*</span><span class="n">r_crop_scale</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_sc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3042db5110aac3d191b58211e3b48b0c2576b37e4f77023367175108f2cb8ed3.png" src="../_images/3042db5110aac3d191b58211e3b48b0c2576b37e4f77023367175108f2cb8ed3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weighted_average</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">arr_sc</span><span class="p">[:,</span> <span class="mi">120</span><span class="p">:</span><span class="mi">335</span><span class="p">],</span> <span class="n">r_crop_scale</span><span class="p">)</span>  <span class="c1">#not quite the same, the image only includes the slice</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/07b7439876746ee415b04ff27583d8e1177f03d89bfed6c5b1c800a202d4260f.png" src="../_images/07b7439876746ee415b04ff27583d8e1177f03d89bfed6c5b1c800a202d4260f.png" />
</div>
</div>
<p>Now what if we want to blend the curtains in a fancier way? Let‚Äôs get another crop with more background.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_crop_scale_2</span> <span class="o">=</span> <span class="n">arr_red</span><span class="p">[:</span><span class="mi">960</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">980</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r_crop_scale_2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">r_crop_scale_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(480, 480, 3)
</pre></div>
</div>
<img alt="../_images/6f492659abb48feb886266fcc6c8fa55f43b44b851a2a967e96d4066a5633af5.png" src="../_images/6f492659abb48feb886266fcc6c8fa55f43b44b851a2a967e96d4066a5633af5.png" />
</div>
</div>
<p>Here, instead of a constant weight, we will take weights that increase from 0 to 0.8 as we travel from left to right.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mi">480</span><span class="p">)</span> <span class="c1">#480 weights, evenly spaced from 0 to 0.8. Use this for a row of the weights tensor.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#match the 3-dim tensor structure of our image, using 1 row, 480 columns, and 1 depth.</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">weights</span><span class="p">[:,:,:]</span> <span class="o">=</span> <span class="n">x</span> <span class="c1">#broadcast x across all rows of our weights tensor.</span>
<span class="n">weighted_average</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">r_crop_scale_2</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3a2ff1883ed369943c0a35752b9b5cf7ed15967914caeaa503ab45b03fd5d20e.png" src="../_images/3a2ff1883ed369943c0a35752b9b5cf7ed15967914caeaa503ab45b03fd5d20e.png" />
</div>
</div>
<p>Now let‚Äôs do this vertically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mi">480</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#The only difference between this code cell and the previous code cell is the placement of -1.</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">weights</span><span class="p">[:,:,:]</span> <span class="o">=</span> <span class="n">x</span> 
<span class="n">weighted_average</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">r_crop_scale_2</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6f644dcfa0bab1ad6c805b618a55dfec939bc91a225bce67bfe3facbc17399eb.png" src="../_images/6f644dcfa0bab1ad6c805b618a55dfec939bc91a225bce67bfe3facbc17399eb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">480</span><span class="p">)</span> <span class="c1">#runs backwards now</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#The only difference between this code cell and the previous code cell is the placement of -1.</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">weights</span><span class="p">[:,:,:]</span> <span class="o">=</span> <span class="n">x</span> 
<span class="n">weighted_average</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">r_crop_scale_2</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b13f67bde8d778f4c8650defbd2a1fea057f3db8b86fde290a5ffaa5c62d1b23.png" src="../_images/b13f67bde8d778f4c8650defbd2a1fea057f3db8b86fde290a5ffaa5c62d1b23.png" />
</div>
</div>
<p>One last blend here: The Dissolve Blend. Each pixel is randomly taken from one array or the other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">dis_rng</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">480</span><span class="p">,</span><span class="mi">480</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>  <span class="c1">#remember that the max, 2, is excluded, so we only get 0 and 1.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dis_rng</span><span class="p">)</span>
<span class="n">arr_dis</span> <span class="o">=</span> <span class="n">arr</span><span class="o">*</span><span class="n">dis_rng</span>  <span class="c1">#the 1&#39;s in dis_rng determine which pixels in Ash Lake are kept.</span>
<span class="n">r_dis</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">dis_rng</span><span class="p">)</span><span class="o">*</span><span class="n">r_crop_scale_2</span> <span class="c1">#the 0&#39;s in dis_rng become 1&#39;s in 1-dis_rng, and therefore the opposite pixels from The Red Room are kept.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[[1]
  [1]
  [1]
  ...
  [0]
  [1]
  [0]]

 [[0]
  [0]
  [0]
  ...
  [1]
  [0]
  [1]]

 [[1]
  [0]
  [1]
  ...
  [0]
  [1]
  [0]]

 ...

 [[0]
  [0]
  [0]
  ...
  [1]
  [0]
  [1]]

 [[0]
  [0]
  [0]
  ...
  [0]
  [0]
  [1]]

 [[1]
  [0]
  [1]
  ...
  [1]
  [0]
  [0]]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_dis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bfcce3f7ef18b787a89e9f17ab3fea738c603841947a73f4ebacab40dd85f02f.png" src="../_images/bfcce3f7ef18b787a89e9f17ab3fea738c603841947a73f4ebacab40dd85f02f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">r_dis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/09d42dda5a08ca2bb24c3b644cfff61c9eba8cd6fd83d57be058243b3a071be5.png" src="../_images/09d42dda5a08ca2bb24c3b644cfff61c9eba8cd6fd83d57be058243b3a071be5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_dis</span> <span class="o">+</span> <span class="n">r_dis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fc7a212930b4574d03a2ebabaf884f872560ce9c63b5f81cc87d74f8d37d480a.png" src="../_images/fc7a212930b4574d03a2ebabaf884f872560ce9c63b5f81cc87d74f8d37d480a.png" />
</div>
</div>
</section>
<section id="averaging-images-in-2d-video-game-graphics-transparent-water">
<h3>Averaging images in 2D video game graphics: Transparent water<a class="headerlink" href="#averaging-images-in-2d-video-game-graphics-transparent-water" title="Link to this heading">#</a></h3>
<p>More modern graphics rendering and photo software expand the formatting of pictures from a (#rows, #columns, 3) (Red, Green, Blue) tensor to a (#rows, #columns, 4) (Red, Green, Blue, Alpha) tensor. The Alpha = 255 means that a pixel is completely opaque, while decreasing Alpha makes that pixel more and more transparent, until  Alpha = 0 gives a totally invisible pixel.</p>
<p>However, the graphics in popular early game consoles (Super Nintendo, Sega Genesis, etc.) were not designed using an Alpha value that could be manipulated. Yet transparent graphical effects were definitely present. How did they manage this with only a (Red, Green, Blue) image?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span><span class="s1">&#39;130943.png&#39;</span><span class="p">)</span>  <span class="c1">#Water Temple</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>images\130943.png
</pre></div>
</div>
<img alt="../_images/f58966efd3c4ba0db181008266b947defbf7ab888503d1bca11a225526960b95.png" src="../_images/f58966efd3c4ba0db181008266b947defbf7ab888503d1bca11a225526960b95.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span><span class="s1">&#39;130942.png&#39;</span><span class="p">)</span> <span class="c1">#The water in the water temple</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>images\130942.png
</pre></div>
</div>
<img alt="../_images/46ec2403c96149f61e808887807011e3b23f648e9daf0cec6a204fb2d62c8bed.png" src="../_images/46ec2403c96149f61e808887807011e3b23f648e9daf0cec6a204fb2d62c8bed.png" />
</div>
</div>
<p>In practice, the parts of the picture that appear transparent or clear above are actually stored in-game as a different color altogether. Often a  bright hot pink or bright lime green are used, so that the game later knows to ignore this color (think of how movies with CG are green screened).</p>
<p>Averaging two arrays together will be close to the proper transparency effect, but not quite correct.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_temple</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span>
<span class="n">arr_watermap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span>
<span class="n">weighted_average</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">arr_temple</span><span class="p">,</span> <span class="n">arr_watermap</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/09774540c5bf98b1c3c09500f9ac6499807e7f1468200ddb8c91cffd11a5cc3b.png" src="../_images/09774540c5bf98b1c3c09500f9ac6499807e7f1468200ddb8c91cffd11a5cc3b.png" />
</div>
</div>
<p>The actual transparency effect works, but averaging the entire image causes the non-water parts of the image to darken.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_watermap</span> <span class="c1">#The &quot;Transparent&quot; pixels are actually stored as a dark green, for some reason. [48, 80, 32]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[48, 80, 32],
        [48, 80, 32],
        [48, 80, 32],
        ...,
        [48, 80, 32],
        [48, 80, 32],
        [48, 80, 32]],

       [[48, 80, 32],
        [48, 80, 32],
        [48, 80, 32],
        ...,
        [48, 80, 32],
        [48, 80, 32],
        [48, 80, 32]],

       [[48, 80, 32],
        [48, 80, 32],
        [48, 80, 32],
        ...,
        [48, 80, 32],
        [48, 80, 32],
        [48, 80, 32]],

       ...,

       [[48, 80, 32],
        [48, 80, 32],
        [48, 80, 32],
        ...,
        [48, 80, 32],
        [48, 80, 32],
        [48, 80, 32]],

       [[48, 80, 32],
        [48, 80, 32],
        [48, 80, 32],
        ...,
        [48, 80, 32],
        [48, 80, 32],
        [48, 80, 32]],

       [[48, 80, 32],
        [48, 80, 32],
        [48, 80, 32],
        ...,
        [48, 80, 32],
        [48, 80, 32],
        [48, 80, 32]]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">bool</span> <span class="o">=</span> <span class="n">arr_watermap</span> <span class="o">==</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span>   <span class="c1">#Find all the places where the dark green color is present in the watermap</span>
<span class="nb">bool</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       [[ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       [[ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       ...,

       [[ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       [[ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       [[ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_watermap_2</span> <span class="o">=</span> <span class="n">arr_watermap</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>   <span class="c1">#Take a copy of the original watermap</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_watermap_2</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr_temple</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>  <span class="c1">#Any pixel with the dark green in the watermap is replaced with the Temple background.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_watermap_2</span><span class="p">)</span> <span class="c1">#Now the watermap has the background image. There&#39;s no transparency, but we&#39;re one step away!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c81b3d8ea983ae6446e4c93cd3f795d95a4edc681bdd06dfa7c331e641e324d1.png" src="../_images/c81b3d8ea983ae6446e4c93cd3f795d95a4edc681bdd06dfa7c331e641e324d1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weighted_average</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">arr_temple</span><span class="p">,</span> <span class="n">arr_watermap_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2d8514deec90712f94973f1e6343f62d3a4e8ce0c88f1f370a0ac4aa62311c90.png" src="../_images/2d8514deec90712f94973f1e6343f62d3a4e8ce0c88f1f370a0ac4aa62311c90.png" />
</div>
</div>
<p>Let‚Äôs combine all of the steps into one function, and try this process again in a few other cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">transparent_layer</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">arr_bg</span><span class="p">,</span> <span class="n">arr_transp</span><span class="p">):</span>
    <span class="nb">bool</span> <span class="o">=</span> <span class="n">arr_transp</span> <span class="o">==</span> <span class="n">mask</span>
    <span class="n">arr_transp</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr_bg</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">weighted_average</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">arr_bg</span><span class="p">,</span> <span class="n">arr_transp</span><span class="p">)</span>  <span class="c1">#The picture won&#39;t show if we don&#39;t store this as a variable, and then return it</span>
    <span class="k">return</span> <span class="n">img</span>
</pre></div>
</div>
</div>
</div>
<p>Original image, but now the water is more transparent further from the temple. Gives the effect that the water is drying up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pic_height</span> <span class="o">=</span> <span class="n">arr_temple</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="n">pic_height</span><span class="p">)</span> 
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">arr_temple</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">weights</span><span class="p">[:,:,:]</span> <span class="o">=</span> <span class="n">x</span> 

<span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span>

<span class="n">transparent_layer</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">arr_temple</span><span class="p">,</span> <span class="n">arr_watermap_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/258cef774827ae6ed567bfb88303ae3e5d84f13b9fb6dac0d6c10c5ab44a4d87.png" src="../_images/258cef774827ae6ed567bfb88303ae3e5d84f13b9fb6dac0d6c10c5ab44a4d87.png" />
</div>
</div>
<p>Does this averaging effect work on rays of light in a cave?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span><span class="s1">&#39;132767.png&#39;</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span><span class="s1">&#39;132766.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5a7d93e87c0ccc229f36b9e7c0013daee09823b0e05e5c16276380e0332d936e.png" src="../_images/5a7d93e87c0ccc229f36b9e7c0013daee09823b0e05e5c16276380e0332d936e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/249330bc605833d12fecbba78a79b3ce9b9b7ace76655d7d58f8976953ebe93a.png" src="../_images/249330bc605833d12fecbba78a79b3ce9b9b7ace76655d7d58f8976953ebe93a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_cave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span>
<span class="n">arr_lightmap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span>
<span class="n">arr_lightmap_2</span> <span class="o">=</span> <span class="n">arr_lightmap</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1">#we&#39;ll see why taking a copy is important soon</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr_lightmap_2</span><span class="p">)</span>  <span class="c1">#The mask color is [0,0,0]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[[0 0 0]
  [0 0 0]
  [0 0 0]
  ...
  [0 0 0]
  [0 0 0]
  [0 0 0]]

 [[0 0 0]
  [0 0 0]
  [0 0 0]
  ...
  [0 0 0]
  [0 0 0]
  [0 0 0]]

 [[0 0 0]
  [0 0 0]
  [0 0 0]
  ...
  [0 0 0]
  [0 0 0]
  [0 0 0]]

 ...

 [[0 0 0]
  [0 0 0]
  [0 0 0]
  ...
  [0 0 0]
  [0 0 0]
  [0 0 0]]

 [[0 0 0]
  [0 0 0]
  [0 0 0]
  ...
  [0 0 0]
  [0 0 0]
  [0 0 0]]

 [[0 0 0]
  [0 0 0]
  [0 0 0]
  ...
  [0 0 0]
  [0 0 0]
  [0 0 0]]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weighted_average</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">arr_cave</span><span class="p">,</span> <span class="n">arr_lightmap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/890c3198451e70cb9f8e37a7e77850ce2e65c4ac532766d7c59910cf4d51d3f0.png" src="../_images/890c3198451e70cb9f8e37a7e77850ce2e65c4ac532766d7c59910cf4d51d3f0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">transparent_layer</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">arr_cave</span><span class="p">,</span> <span class="n">arr_lightmap_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/215b999a52d1beff3f98413043c0690f244bf96ac6dfcf50b99c0f84d06850fd.png" src="../_images/215b999a52d1beff3f98413043c0690f244bf96ac6dfcf50b99c0f84d06850fd.png" />
</div>
</div>
<p>Conclusion: Averaging works better when we actually want to darken the background!</p>
<p>You can also save images that you generate as separate files. You just need to save the image as a variable first. See the code below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cave_img</span> <span class="o">=</span> <span class="n">weighted_average</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">arr_cave</span><span class="p">,</span> <span class="n">arr_lightmap</span><span class="p">)</span>
<span class="n">cave_img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;cavelight.png&quot;</span><span class="p">)</span>

<span class="n">drying_temple</span> <span class="o">=</span> <span class="n">transparent_layer</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">arr_temple</span><span class="p">,</span> <span class="n">arr_watermap_2</span><span class="p">)</span>
<span class="n">drying_temple</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;dryingtemple.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="setting-colors">
<h3>Setting Colors<a class="headerlink" href="#setting-colors" title="Link to this heading">#</a></h3>
<p><strong>Goal:</strong> Change a horizontal band of the image to a single color.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;ash-lake.png&quot;</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs start by getting a horizontal band.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5e1d90f6446401945200baa3bef12c94914b832e16b31b8acc7a14a9a978421f.png" src="../_images/5e1d90f6446401945200baa3bef12c94914b832e16b31b8acc7a14a9a978421f.png" />
</div>
</div>
<p>This is going to throw an error!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">92</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">arr</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="ne">ValueError</span>: assignment destination is read-only
</pre></div>
</div>
</div>
</div>
<p>Main point: <code class="docutils literal notranslate"><span class="pre">img</span></code> and <code class="docutils literal notranslate"><span class="pre">arr</span></code> are <em>references</em> to the image. What this means for us is that we can look, but we can‚Äôt change anything. To get around this, we work on a copy!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The size of <code class="docutils literal notranslate"><span class="pre">img</span></code> is SO small! This is because it‚Äôs a reference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>48
</pre></div>
</div>
</div>
</div>
<p>The size of <code class="docutils literal notranslate"><span class="pre">arr</span></code> is still pretty small!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>144
</pre></div>
</div>
</div>
</div>
<p>Now that <code class="docutils literal notranslate"><span class="pre">B</span></code> is not a reference to anything else, the values must be stored independently of <code class="docutils literal notranslate"><span class="pre">img</span></code>. This leads <code class="docutils literal notranslate"><span class="pre">B</span></code> to have a large size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>691344
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>   <span class="c1">#to compare how sizing works</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1">#big array requires a larger size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8000128
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="c1">#b is a reference to a, but a is already large</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8000128
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/49f6aa493407114c3d1edf148b3d309f721527b1ae384e894fea034e50f0a8f8.png" src="../_images/49f6aa493407114c3d1edf148b3d309f721527b1ae384e894fea034e50f0a8f8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/972127492fc8d86d90b7a219201cca4e1e5429a6e6e21c07b9ba5927242a72fb.png" src="../_images/972127492fc8d86d90b7a219201cca4e1e5429a6e6e21c07b9ba5927242a72fb.png" />
</div>
</div>
<p>Remember, <code class="docutils literal notranslate"><span class="pre">[83,</span> <span class="pre">161,</span> <span class="pre">148]</span></code> was the top-left-most color from earlier:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">83</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">148</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100, 480, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/81a3b53cb3bc4a26e6e8fb79bc91e2dbfbe9ae957936badc1fb43a3b57489fac.png" src="../_images/81a3b53cb3bc4a26e6e8fb79bc91e2dbfbe9ae957936badc1fb43a3b57489fac.png" />
</div>
</div>
<p>Just for fun! From <a href="https://www.google.com/search?q=rgb+color+picker" target="_blank">Google‚Äôs color picker</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">234</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">197</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fbfd38252e3abcee81392e4cede83454c4fdd5d334e54b2d7fae071f1fc53b47.png" src="../_images/fbfd38252e3abcee81392e4cede83454c4fdd5d334e54b2d7fae071f1fc53b47.png" />
</div>
</div>
</section>
<section id="making-an-image-from-scratch">
<h3>Making an image from scratch<a class="headerlink" href="#making-an-image-from-scratch" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">],[</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">]]])</span>
<span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 2, 3)
</pre></div>
</div>
</div>
</div>
<p>I‚Äôll start by making an error :)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File C:\ProgramData\anaconda3\Lib\site-packages\PIL\Image.py:3277,</span> in <span class="ni">fromarray</span><span class="nt">(obj, mode)</span>
<span class="g g-Whitespace">   </span><span class="mi">3276</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3277</span>     <span class="n">mode</span><span class="p">,</span> <span class="n">rawmode</span> <span class="o">=</span> <span class="n">_fromarray_typemap</span><span class="p">[</span><span class="n">typekey</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">3278</span> <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="ne">KeyError</span>: ((1, 1, 3), &#39;&lt;i4&#39;)

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">114</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

<span class="nn">File C:\ProgramData\anaconda3\Lib\site-packages\PIL\Image.py:3281,</span> in <span class="ni">fromarray</span><span class="nt">(obj, mode)</span>
<span class="g g-Whitespace">   </span><span class="mi">3279</span>         <span class="n">typekey_shape</span><span class="p">,</span> <span class="n">typestr</span> <span class="o">=</span> <span class="n">typekey</span>
<span class="g g-Whitespace">   </span><span class="mi">3280</span>         <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Cannot handle this data type: </span><span class="si">{</span><span class="n">typekey_shape</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">typestr</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="ne">-&gt; </span><span class="mi">3281</span>         <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
<span class="g g-Whitespace">   </span><span class="mi">3282</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3283</span>     <span class="n">rawmode</span> <span class="o">=</span> <span class="n">mode</span>

<span class="ne">TypeError</span>: Cannot handle this data type: (1, 1, 3), &lt;i4
</pre></div>
</div>
</div>
</div>
<p>The issue here is that I haven‚Äôt specified a data type. What should it be?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">],[</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">]]],</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You might think there‚Äôs another error when we run this‚Ä¶</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/881b823d1869c6259af46372f3a4557e15c0dff24033760233bdcfb9a465e758.png" src="../_images/881b823d1869c6259af46372f3a4557e15c0dff24033760233bdcfb9a465e758.png" />
</div>
</div>
<p>No error, it‚Äôs just 2 pixels by 2 pixels‚Ä¶super small and hard to see.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/393e7ef3ab452ef8b6b481f1ad30e9b874432003df0ddcfcc8129adf3a6b944e.png" src="../_images/393e7ef3ab452ef8b6b481f1ad30e9b874432003df0ddcfcc8129adf3a6b944e.png" />
</div>
</div>
<p>Maybe I don‚Äôt like how it has extended the pixels (the blurring).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on method resize in module PIL.Image:

resize(size: &#39;tuple[int, int]&#39;, resample: &#39;int | None&#39; = None, box: &#39;tuple[float, float, float, float] | None&#39; = None, reducing_gap: &#39;float | None&#39; = None) -&gt; &#39;Image&#39; method of PIL.Image.Image instance
    Returns a resized copy of this image.

    :param size: The requested size in pixels, as a 2-tuple:
       (width, height).
    :param resample: An optional resampling filter.  This can be
       one of :py:data:`Resampling.NEAREST`, :py:data:`Resampling.BOX`,
       :py:data:`Resampling.BILINEAR`, :py:data:`Resampling.HAMMING`,
       :py:data:`Resampling.BICUBIC` or :py:data:`Resampling.LANCZOS`.
       If the image has mode &quot;1&quot; or &quot;P&quot;, it is always set to
       :py:data:`Resampling.NEAREST`. If the image mode specifies a number
       of bits, such as &quot;I;16&quot;, then the default filter is
       :py:data:`Resampling.NEAREST`. Otherwise, the default filter is
       :py:data:`Resampling.BICUBIC`. See: :ref:`concept-filters`.
    :param box: An optional 4-tuple of floats providing
       the source image region to be scaled.
       The values must be within (0, 0, width, height) rectangle.
       If omitted or None, the entire source is used.
    :param reducing_gap: Apply optimization by resizing the image
       in two steps. First, reducing the image by integer times
       using :py:meth:`~PIL.Image.Image.reduce`.
       Second, resizing using regular resampling. The last step
       changes size no less than by ``reducing_gap`` times.
       ``reducing_gap`` may be None (no first step is performed)
       or should be greater than 1.0. The bigger ``reducing_gap``,
       the closer the result to the fair resampling.
       The smaller ``reducing_gap``, the faster resizing.
       With ``reducing_gap`` greater or equal to 3.0, the result is
       indistinguishable from fair resampling in most cases.
       The default value is None (no optimization).
    :returns: An :py:class:`~PIL.Image.Image` object.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;BICUBIC&#39;,
 &#39;BILINEAR&#39;,
 &#39;BOX&#39;,
 &#39;HAMMING&#39;,
 &#39;LANCZOS&#39;,
 &#39;NEAREST&#39;,
 &#39;__abs__&#39;,
 &#39;__add__&#39;,
 &#39;__and__&#39;,
 &#39;__bool__&#39;,
 &#39;__ceil__&#39;,
 &#39;__class__&#39;,
 &#39;__contains__&#39;,
 &#39;__delattr__&#39;,
 &#39;__dir__&#39;,
 &#39;__divmod__&#39;,
 &#39;__doc__&#39;,
 &#39;__eq__&#39;,
 &#39;__float__&#39;,
 &#39;__floor__&#39;,
 &#39;__floordiv__&#39;,
 &#39;__format__&#39;,
 &#39;__ge__&#39;,
 &#39;__getattribute__&#39;,
 &#39;__getitem__&#39;,
 &#39;__getnewargs__&#39;,
 &#39;__getstate__&#39;,
 &#39;__gt__&#39;,
 &#39;__hash__&#39;,
 &#39;__index__&#39;,
 &#39;__init__&#39;,
 &#39;__init_subclass__&#39;,
 &#39;__int__&#39;,
 &#39;__invert__&#39;,
 &#39;__iter__&#39;,
 &#39;__le__&#39;,
 &#39;__len__&#39;,
 &#39;__lshift__&#39;,
 &#39;__lt__&#39;,
 &#39;__members__&#39;,
 &#39;__mod__&#39;,
 &#39;__module__&#39;,
 &#39;__mul__&#39;,
 &#39;__name__&#39;,
 &#39;__ne__&#39;,
 &#39;__neg__&#39;,
 &#39;__new__&#39;,
 &#39;__or__&#39;,
 &#39;__pos__&#39;,
 &#39;__pow__&#39;,
 &#39;__qualname__&#39;,
 &#39;__radd__&#39;,
 &#39;__rand__&#39;,
 &#39;__rdivmod__&#39;,
 &#39;__reduce__&#39;,
 &#39;__reduce_ex__&#39;,
 &#39;__repr__&#39;,
 &#39;__rfloordiv__&#39;,
 &#39;__rlshift__&#39;,
 &#39;__rmod__&#39;,
 &#39;__rmul__&#39;,
 &#39;__ror__&#39;,
 &#39;__round__&#39;,
 &#39;__rpow__&#39;,
 &#39;__rrshift__&#39;,
 &#39;__rshift__&#39;,
 &#39;__rsub__&#39;,
 &#39;__rtruediv__&#39;,
 &#39;__rxor__&#39;,
 &#39;__setattr__&#39;,
 &#39;__sizeof__&#39;,
 &#39;__str__&#39;,
 &#39;__sub__&#39;,
 &#39;__subclasshook__&#39;,
 &#39;__truediv__&#39;,
 &#39;__trunc__&#39;,
 &#39;__xor__&#39;,
 &#39;as_integer_ratio&#39;,
 &#39;bit_count&#39;,
 &#39;bit_length&#39;,
 &#39;conjugate&#39;,
 &#39;denominator&#39;,
 &#39;from_bytes&#39;,
 &#39;imag&#39;,
 &#39;is_integer&#39;,
 &#39;numerator&#39;,
 &#39;real&#39;,
 &#39;to_bytes&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;_&#39;</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BICUBIC
BILINEAR
BOX
HAMMING
LANCZOS
NEAREST
</pre></div>
</div>
</div>
</div>
<p>There is an issue in how we join <code class="docutils literal notranslate"><span class="pre">s</span></code> to the end.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;_&#39;</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span><span class="n">resample</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BICUBIC
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">122</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;_&#39;</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">4</span>     <span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span><span class="n">resample</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">s</span><span class="p">))</span>

<span class="ne">AttributeError</span>: type object &#39;Resampling&#39; has no attribute &#39;s&#39;
</pre></div>
</div>
</div>
</div>
<p><strong>Fix 1:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;_&#39;</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span><span class="n">resample</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="p">,</span><span class="n">s</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BICUBIC
</pre></div>
</div>
<img alt="../_images/393e7ef3ab452ef8b6b481f1ad30e9b874432003df0ddcfcc8129adf3a6b944e.png" src="../_images/393e7ef3ab452ef8b6b481f1ad30e9b874432003df0ddcfcc8129adf3a6b944e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BILINEAR
</pre></div>
</div>
<img alt="../_images/7d26d76de6b740114d5e02b63a147f42836c3347c24e68a78050a4694898783e.png" src="../_images/7d26d76de6b740114d5e02b63a147f42836c3347c24e68a78050a4694898783e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BOX
</pre></div>
</div>
<img alt="../_images/6c075dc85fbad55a8773f512a3531869cd374f5c4a57ac3768a8846d168e35d5.png" src="../_images/6c075dc85fbad55a8773f512a3531869cd374f5c4a57ac3768a8846d168e35d5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HAMMING
</pre></div>
</div>
<img alt="../_images/1f82cc51bda8839fc6fbee8782c17d9dbfa3e5a785328098867ffbab4846ae23.png" src="../_images/1f82cc51bda8839fc6fbee8782c17d9dbfa3e5a785328098867ffbab4846ae23.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LANCZOS
</pre></div>
</div>
<img alt="../_images/535db0528886cc9ed2aa3a09e5b0f69762a39a6b701f4a09a832946e7063e196.png" src="../_images/535db0528886cc9ed2aa3a09e5b0f69762a39a6b701f4a09a832946e7063e196.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NEAREST
</pre></div>
</div>
<img alt="../_images/6c075dc85fbad55a8773f512a3531869cd374f5c4a57ac3768a8846d168e35d5.png" src="../_images/6c075dc85fbad55a8773f512a3531869cd374f5c4a57ac3768a8846d168e35d5.png" />
</div>
</div>
<p><strong>Fix 2:</strong> This method is less flexible (I wouldn‚Äôt usually expect it to work), but it does the job in this case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;_&#39;</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span><span class="n">resample</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="p">[</span><span class="n">s</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BICUBIC
</pre></div>
</div>
<img alt="../_images/393e7ef3ab452ef8b6b481f1ad30e9b874432003df0ddcfcc8129adf3a6b944e.png" src="../_images/393e7ef3ab452ef8b6b481f1ad30e9b874432003df0ddcfcc8129adf3a6b944e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BILINEAR
</pre></div>
</div>
<img alt="../_images/7d26d76de6b740114d5e02b63a147f42836c3347c24e68a78050a4694898783e.png" src="../_images/7d26d76de6b740114d5e02b63a147f42836c3347c24e68a78050a4694898783e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BOX
</pre></div>
</div>
<img alt="../_images/6c075dc85fbad55a8773f512a3531869cd374f5c4a57ac3768a8846d168e35d5.png" src="../_images/6c075dc85fbad55a8773f512a3531869cd374f5c4a57ac3768a8846d168e35d5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HAMMING
</pre></div>
</div>
<img alt="../_images/1f82cc51bda8839fc6fbee8782c17d9dbfa3e5a785328098867ffbab4846ae23.png" src="../_images/1f82cc51bda8839fc6fbee8782c17d9dbfa3e5a785328098867ffbab4846ae23.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LANCZOS
</pre></div>
</div>
<img alt="../_images/535db0528886cc9ed2aa3a09e5b0f69762a39a6b701f4a09a832946e7063e196.png" src="../_images/535db0528886cc9ed2aa3a09e5b0f69762a39a6b701f4a09a832946e7063e196.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NEAREST
</pre></div>
</div>
<img alt="../_images/6c075dc85fbad55a8773f512a3531869cd374f5c4a57ac3768a8846d168e35d5.png" src="../_images/6c075dc85fbad55a8773f512a3531869cd374f5c4a57ac3768a8846d168e35d5.png" />
</div>
</div>
</section>
<section id="swapping-color-channels">
<h3>Swapping color channels<a class="headerlink" href="#swapping-color-channels" title="Link to this heading">#</a></h3>
<p><strong>Goal:</strong> Want to swap the Red and Blue color channels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;ash-lake.png&quot;</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 83, 161, 148],
        [ 83, 161, 148],
        [ 83, 161, 148],
        ...,
        [ 94, 157, 140],
        [ 94, 157, 140],
        [ 94, 157, 140]],

       [[ 83, 161, 148],
        [ 83, 161, 148],
        [ 83, 161, 148],
        ...,
        [ 93, 156, 139],
        [ 93, 156, 139],
        [ 93, 156, 139]],

       [[ 83, 161, 148],
        [ 83, 161, 148],
        [ 83, 161, 148],
        ...,
        [ 93, 156, 139],
        [ 92, 155, 138],
        [ 92, 155, 138]],

       ...,

       [[117, 128, 120],
        [140, 151, 143],
        [152, 163, 155],
        ...,
        [113, 126, 119],
        [117, 130, 123],
        [121, 134, 127]],

       [[128, 139, 131],
        [129, 140, 132],
        [124, 135, 127],
        ...,
        [112, 125, 118],
        [114, 127, 120],
        [116, 129, 122]],

       [[130, 141, 133],
        [118, 129, 121],
        [105, 117, 107],
        ...,
        [119, 132, 125],
        [120, 133, 126],
        [121, 134, 127]]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<p>This might be trickier than you‚Äôd expect. I‚Äôll start by making a common mistake.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">148</span><span class="p">]</span>
<span class="n">mylist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">mylist</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1">#mylist[0] original value is overwritten</span>
<span class="n">mylist</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">mylist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#mylist[0] already equals mylist[2], so no change occurs.</span>
<span class="n">mylist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[148, 161, 148]
</pre></div>
</div>
</div>
</div>
<p>Common way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">148</span><span class="p">]</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">mylist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mylist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">mylist</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">mylist</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
<span class="n">mylist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[148, 161, 83]
</pre></div>
</div>
</div>
</div>
<p>We want to use this idea and apply it to all of <code class="docutils literal notranslate"><span class="pre">arr</span></code>. Again, there will be mistakes here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#Red values; pointing to B - if B changes, so does temp</span>
<span class="n">B</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">B</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([148, 161, 148], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp2</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>128
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">temp2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230528
</pre></div>
</div>
</div>
</div>
<p>Here‚Äôs how we can swap channels using the fact that <code class="docutils literal notranslate"><span class="pre">arr</span></code> is read-only</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Swaps the Red and Blue Channels</span>
<span class="n">B_rb</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">B_rb</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">B_rb</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_rb</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([148, 161,  83], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" src="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_rb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f1c90929dde60c1d17fe8f50d331f8f626329943b4635583851fcf5acda84940.png" src="../_images/f1c90929dde60c1d17fe8f50d331f8f626329943b4635583851fcf5acda84940.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Swaps the Red and Green Channels</span>
<span class="n">B_rg</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">B_rg</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">B_rg</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_rg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9011008b805ff85459cc7278d65da39fc63ccf786accebc6e0c79a9759c96eec.png" src="../_images/9011008b805ff85459cc7278d65da39fc63ccf786accebc6e0c79a9759c96eec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Swaps the Green and Blue Channels</span>
<span class="n">B_gb</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">B_gb</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">B_gb</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_gb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2e87fefce03389716fa40d8f33579b6cd9be68d25f4a225f06ee3be2048ca7d2.png" src="../_images/2e87fefce03389716fa40d8f33579b6cd9be68d25f4a225f06ee3be2048ca7d2.png" />
</div>
</div>
<p>In practice, we can swap any two channels we want. We can even swap all 3 if we‚Äôd like. Let‚Äôs make a function so it‚Äôs easier to do.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">channel_swap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">swap</span><span class="p">):</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">B</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="n">swap</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">B</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="n">swap</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">B</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="n">swap</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">B</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">channel_swap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/00e5b5c2f1cf5b523ec08ad4cde9add184c3bd88d62647c32e8fa6c0b1a94bf0.png" src="../_images/00e5b5c2f1cf5b523ec08ad4cde9add184c3bd88d62647c32e8fa6c0b1a94bf0.png" />
</div>
</div>
</section>
</section>
<section id="invert-colors">
<h2>Invert Colors<a class="headerlink" href="#invert-colors" title="Link to this heading">#</a></h2>
<p>Each color channel is flipped from high to low and vice versa. If <span class="math notranslate nohighlight">\(C_{invert}\)</span> is the new particular color, and <span class="math notranslate nohighlight">\(C_{old}\)</span> is the original, we want</p>
<p><span class="math notranslate nohighlight">\(C_{invert} = 255 - C_{old}\)</span></p>
<p>This is very easy to broadcast across the entire array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" src="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#invert colors, each RGB value is flipped opposite</span>
<span class="n">B_inv</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">B_inv</span> <span class="o">=</span> <span class="mi">255</span><span class="o">-</span><span class="n">B_inv</span>  
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_inv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/06612145b6aece43be5cc1628b6c1792280d686907a416b17d7f99a977c4945e.png" src="../_images/06612145b6aece43be5cc1628b6c1792280d686907a416b17d7f99a977c4945e.png" />
</div>
</div>
<p>We‚Äôll turn our code above into a function for future use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">invert_colors</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">B</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">-</span> <span class="n">B</span>
    <span class="k">return</span> <span class="n">B</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">invert_colors</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/06612145b6aece43be5cc1628b6c1792280d686907a416b17d7f99a977c4945e.png" src="../_images/06612145b6aece43be5cc1628b6c1792280d686907a416b17d7f99a977c4945e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#invert colors on the Red-Blue swap</span>
<span class="n">B_rb_inv</span> <span class="o">=</span> <span class="n">channel_swap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#we apply the functions one at a time in this cell. First channel swap</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">))</span>
<span class="n">B_rb_inv</span> <span class="o">=</span> <span class="n">invert_colors</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">)</span> <span class="c1">#then invert colors. The order does not matter.</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f1c90929dde60c1d17fe8f50d331f8f626329943b4635583851fcf5acda84940.png" src="../_images/f1c90929dde60c1d17fe8f50d331f8f626329943b4635583851fcf5acda84940.png" />
<img alt="../_images/92b9f3b4fad7bdf16987127b3d85f5d11420b2700346a0966638959c324185e1.png" src="../_images/92b9f3b4fad7bdf16987127b3d85f5d11420b2700346a0966638959c324185e1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#invert colors on the Red-Green swap</span>
<span class="n">B_rg_inv</span> <span class="o">=</span> <span class="n">invert_colors</span><span class="p">(</span><span class="n">channel_swap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span> <span class="c1">#both functions are nested in each other this time.</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_rg_inv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e03682a292e44d8f1292524321c01b4e88fe0f466fce3bb683a6619d1b002550.png" src="../_images/e03682a292e44d8f1292524321c01b4e88fe0f466fce3bb683a6619d1b002550.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#invert colors on the Green-Blue swap</span>
<span class="n">B_gb_inv</span> <span class="o">=</span> <span class="n">invert_colors</span><span class="p">(</span><span class="n">channel_swap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span> <span class="c1">#both functions are nested in each other this time.</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_gb_inv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/de232bd71bd68bc6f64d8ee9d4279ce7c4bdc3a5cde8f058b04f910892d6a1cb.png" src="../_images/de232bd71bd68bc6f64d8ee9d4279ce7c4bdc3a5cde8f058b04f910892d6a1cb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z_inv</span> <span class="o">=</span> <span class="n">invert_colors</span><span class="p">(</span><span class="n">channel_swap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Z_inv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/08f0bd0c1ad084e39bf0f9192df5f90b1a1707e55893c0a0ca1fb5b69d24e0bb.png" src="../_images/08f0bd0c1ad084e39bf0f9192df5f90b1a1707e55893c0a0ca1fb5b69d24e0bb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generalized_invert_colors</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">C</span> <span class="o">-</span> <span class="n">B</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="n">Bshape</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">shape</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="n">Bshape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">generalized_invert_colors</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">C</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/583e1b0bf922a019949db2204851e3caafd92a744211a370dc02a39c7f7bdc5d.png" src="../_images/583e1b0bf922a019949db2204851e3caafd92a744211a370dc02a39c7f7bdc5d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">generalized_invert_colors</span><span class="p">(</span><span class="n">channel_swap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">C</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/32e2a1a3883d93af2f54db993fec71da86de73a4edcb442d51a0f60c73f63350.png" src="../_images/32e2a1a3883d93af2f54db993fec71da86de73a4edcb442d51a0f60c73f63350.png" />
</div>
</div>
</section>
<section id="threshold-filter">
<h2>Threshold filter<a class="headerlink" href="#threshold-filter" title="Link to this heading">#</a></h2>
<p>Across all 3 color channels, we set a Threshold value. Per pixel, any color channel with value above the threshold is set to a max of 255. Any color channel below this threshold is set to 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Threshold filter</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">B_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="n">thresh</span> <span class="o">=</span> <span class="mi">125</span>  <span class="c1">#color channels over this value will be increased to the max value, which is 255. Otherwise, they are 0.</span>
<span class="c1">#interesting values for this picture: thresh = 50, 70, 125, 150</span>

<span class="n">B_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">((</span><span class="n">B</span> <span class="o">&gt;</span> <span class="n">thresh</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_th</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d2485b5a0975f6c605de997365cb522df0a26a4158f290246e31919e6c4364ec.png" src="../_images/d2485b5a0975f6c605de997365cb522df0a26a4158f290246e31919e6c4364ec.png" />
</div>
</div>
</section>
<section id="brighten-darken-image">
<h2>Brighten/Darken Image<a class="headerlink" href="#brighten-darken-image" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;ash-lake.png&quot;</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" src="../_images/97f5b31ae93ee614881a883de2b372af81c6489db776705ebb3e89f88041b1ec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_dark</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">c</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1">#Darken, use constant between 0 and 1</span>
<span class="n">B_dark</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">B_dark</span><span class="p">)</span>  <span class="c1">#pixels must be 8-bit integers.</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_dark</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/67128f76bc4c24f03d35f7b550366400dec4772f8e34f502331ab2a800a4a723.png" src="../_images/67128f76bc4c24f03d35f7b550366400dec4772f8e34f502331ab2a800a4a723.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">c</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="c1">#Brighten, use constant greater than 1. </span>
<span class="c1">#But too high constant causes some color channels to go above 255.</span>
<span class="c1">#c = 5 is gives weird and abstract rainbow colorings</span>
<span class="c1">#negative numbers also give weird colorings.</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">B</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d25853a801427024182c17b17a65fbd324f1f63049e180253720fa5b674afe26.png" src="../_images/d25853a801427024182c17b17a65fbd324f1f63049e180253720fa5b674afe26.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">c</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#Brighten gone wrong. The pixel values roll over.</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">B</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/341bd2cf0f31c526509138b6b28c084e96be1851f746f24e03174a5e85149d9e.png" src="../_images/341bd2cf0f31c526509138b6b28c084e96be1851f746f24e03174a5e85149d9e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">c</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#More Brighten gone wrong. The pixel values roll over.</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">B</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0c5d276236d6bb6381a71b025a915149168056c8aadcfb8d668f9af8df24841e.png" src="../_images/0c5d276236d6bb6381a71b025a915149168056c8aadcfb8d668f9af8df24841e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="c1">#weird negative number result</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">B</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ea433f9a6716ef8a2ccb433026367f8314f4c3d48456bc01db488e9e77d14384.png" src="../_images/ea433f9a6716ef8a2ccb433026367f8314f4c3d48456bc01db488e9e77d14384.png" />
</div>
</div>
<p>An 8-bit integer has a maximum value of 255 (8 digits of binary). An overflow rolls over back to 0. You can think of this as doing operations mod 256. High multiples magnify the difference between colors, which is why the colors start to scatter.</p>
<p>To fix these issues, we have to replace any color channel above 255 with exactly 255, before we convert to <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code> type. Boolean indexing comes in handy here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

<span class="n">c</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">B</span>
<span class="n">B</span>  <span class="c1">#now we can see what the values are before they roll over.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[249., 483., 444.],
        [249., 483., 444.],
        [249., 483., 444.],
        ...,
        [282., 471., 420.],
        [282., 471., 420.],
        [282., 471., 420.]],

       [[249., 483., 444.],
        [249., 483., 444.],
        [249., 483., 444.],
        ...,
        [279., 468., 417.],
        [279., 468., 417.],
        [279., 468., 417.]],

       [[249., 483., 444.],
        [249., 483., 444.],
        [249., 483., 444.],
        ...,
        [279., 468., 417.],
        [276., 465., 414.],
        [276., 465., 414.]],

       ...,

       [[351., 384., 360.],
        [420., 453., 429.],
        [456., 489., 465.],
        ...,
        [339., 378., 357.],
        [351., 390., 369.],
        [363., 402., 381.]],

       [[384., 417., 393.],
        [387., 420., 396.],
        [372., 405., 381.],
        ...,
        [336., 375., 354.],
        [342., 381., 360.],
        [348., 387., 366.]],

       [[390., 423., 399.],
        [354., 387., 363.],
        [315., 351., 321.],
        ...,
        [357., 396., 375.],
        [360., 399., 378.],
        [363., 402., 381.]]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="c1">#find the values that overflow</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[False,  True,  True],
        [False,  True,  True],
        [False,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       [[False,  True,  True],
        [False,  True,  True],
        [False,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       [[False,  True,  True],
        [False,  True,  True],
        [False,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       ...,

       [[ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       [[ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]],

       [[ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True],
        ...,
        [ True,  True,  True],
        [ True,  True,  True],
        [ True,  True,  True]]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">255</span><span class="o">*</span><span class="p">(</span><span class="n">B</span><span class="o">&gt;</span><span class="mi">255</span><span class="p">)</span> <span class="c1">#True counts as 1, False counts as 0, so we multiply by 255</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[  0, 255, 255],
        [  0, 255, 255],
        [  0, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[  0, 255, 255],
        [  0, 255, 255],
        [  0, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[  0, 255, 255],
        [  0, 255, 255],
        [  0, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="p">(</span><span class="n">B</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)))</span>   <span class="c1">#visualize all of the color channels that overflow, for fun. </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d066687c7a7416de3927a34c3c51bcceddfe9b84342fbdd57e858f6dbe938ce7.png" src="../_images/d066687c7a7416de3927a34c3c51bcceddfe9b84342fbdd57e858f6dbe938ce7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="n">B</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">B</span><span class="p">))</span> <span class="c1">#The final result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b0dc3ea7e13a75e8f5eb0eb5f7908f72fa6ff31b0eb014b8063dc3c28d47b4e8.png" src="../_images/b0dc3ea7e13a75e8f5eb0eb5f7908f72fa6ff31b0eb014b8063dc3c28d47b4e8.png" />
</div>
</div>
<p>We combine our work into one function, all in one cell. <em>Note: There are smarter brightness algorithms than this.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">adjust_lighting</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">L</span>
    <span class="n">L</span><span class="p">[</span><span class="n">L</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">bright_ash</span> <span class="o">=</span> <span class="n">adjust_lighting</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">bright_ash</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ff35b1b70c673c7173a40e1df29face6c76a579ddbfe2bfcec6f66506e0a09e9.png" src="../_images/ff35b1b70c673c7173a40e1df29face6c76a579ddbfe2bfcec6f66506e0a09e9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dark_ash</span> <span class="o">=</span> <span class="n">adjust_lighting</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">dark_ash</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/746bb307daeab7b487f7354c3d465c1ffb0d9e179a5efc86663d0b64f94aeb17.png" src="../_images/746bb307daeab7b487f7354c3d465c1ffb0d9e179a5efc86663d0b64f94aeb17.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Bshape</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">shape</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">Bshape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#Broadcast this row across the entire tensor array</span>
<span class="n">fade_ash</span> <span class="o">=</span> <span class="n">adjust_lighting</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">fade_ash</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9f3a83dbf87835d6c46f323f124d4414d58c51e9d5e321e667de3aa35f2d4590.png" src="../_images/9f3a83dbf87835d6c46f323f124d4414d58c51e9d5e321e667de3aa35f2d4590.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Bshape</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">shape</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="n">Bshape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#Broadcast this row across the entire tensor array</span>
<span class="n">shine_ash</span> <span class="o">=</span> <span class="n">adjust_lighting</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">shine_ash</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f4cd083059394b0bd1a88b765cbcc92c694294f7bb6a40553ad23dd7cbc4544a.png" src="../_images/f4cd083059394b0bd1a88b765cbcc92c694294f7bb6a40553ad23dd7cbc4544a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">C</span><span class="o">*</span><span class="n">arr</span><span class="p">))</span> <span class="c1">#Compare the result above to what happens when we don&#39;t limit the maximum value to 255.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a92115f4b98460589c69822f3455ca94fe834941f4b52e08600c9aff11fd8c99.png" src="../_images/a92115f4b98460589c69822f3455ca94fe834941f4b52e08600c9aff11fd8c99.png" />
</div>
</div>
</section>
<section id="grayscale-filter">
<h2>Grayscale Filter<a class="headerlink" href="#grayscale-filter" title="Link to this heading">#</a></h2>
<p>Gray colors occur when Red = Green = Blue for a particular pixel. But there are easier ways to generate grayscale pictures.</p>
<p>Tensors of shape <span class="math notranslate nohighlight">\((r, c, 3)\)</span> give color pictures. Matrices of shape <span class="math notranslate nohighlight">\((r,c)\)</span> give grayscale images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_gr</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">gray_range</span><span class="p">))</span>
<span class="n">img_gr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/70ea786bb77032363fbcd75a2f38da74d2fcb03168b77d1375a59de1ff73e711.png" src="../_images/70ea786bb77032363fbcd75a2f38da74d2fcb03168b77d1375a59de1ff73e711.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Expander</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="n">big_gr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">gray_range</span><span class="p">,</span> <span class="n">Expander</span><span class="p">)</span>  <span class="c1">#each single number in gray_range is expanded to an nxn block of all the same value</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">big_gr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8e094af9803e1d4fa2754f5ecdd3a15c4cb41ae5830029c743a812a131f7c479.png" src="../_images/8e094af9803e1d4fa2754f5ecdd3a15c4cb41ae5830029c743a812a131f7c479.png" />
</div>
</div>
<p>Let‚Äôs make a grayscale image of Ash lake, just from its red channel. Compare this to the green and blue channels, too.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">arr</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">])))</span>   <span class="c1">#red channel</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">arr</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">])))</span>     <span class="c1">#green channel</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">arr</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">])))</span>    <span class="c1">#blue channel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/22b35697a6886b2998dc87321869e45b73970c35b0941bc7efc41068d8219013.png" src="../_images/22b35697a6886b2998dc87321869e45b73970c35b0941bc7efc41068d8219013.png" />
<img alt="../_images/aeb6da908e2201a3ff16dfecfcc7ac7719d300118ddf0c484856f9d66b71e7f2.png" src="../_images/aeb6da908e2201a3ff16dfecfcc7ac7719d300118ddf0c484856f9d66b71e7f2.png" />
<img alt="../_images/f5e0793ef392cd32b2ba54f2e86a5fd17545ba398d021586373d5584aa0cab00.png" src="../_images/f5e0793ef392cd32b2ba54f2e86a5fd17545ba398d021586373d5584aa0cab00.png" />
</div>
</div>
<section id="a-better-algorithm-for-grayscale">
<h3>A better algorithm for grayscale<a class="headerlink" href="#a-better-algorithm-for-grayscale" title="Link to this heading">#</a></h3>
<p>For each pixel <span class="math notranslate nohighlight">\((i,j)\)</span> of color image <span class="math notranslate nohighlight">\(Y\)</span>, you can use the formula <span class="math notranslate nohighlight">\(Y_{ij} = 0.2125\times Red_{ij} + 0.7154\times Green_{ij} + 0.0721\times Blue_{ij}\)</span> This specific combination of colors is used often in image processing, and can be found on the <a href="https://en.wikipedia.org/wiki/Grayscale"> Wikipedia page for Grayscale</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">arr</span>
<span class="n">Y_bettergray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="mf">0.2125</span><span class="o">*</span><span class="n">Y</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.7154</span><span class="o">*</span><span class="n">Y</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.0721</span><span class="o">*</span><span class="n">Y</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Y_bettergray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fca5d467ff8b53433ccbbd587551e94f8bf47469b7bebb15a810de3827897326.png" src="../_images/fca5d467ff8b53433ccbbd587551e94f8bf47469b7bebb15a810de3827897326.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_bettergray</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(480, 480)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grayscale</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="mf">0.2125</span><span class="o">*</span><span class="n">Y</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.7154</span><span class="o">*</span><span class="n">Y</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.0721</span><span class="o">*</span><span class="n">Y</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">])</span>  <span class="c1">#function version</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">grayscale</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fca5d467ff8b53433ccbbd587551e94f8bf47469b7bebb15a810de3827897326.png" src="../_images/fca5d467ff8b53433ccbbd587551e94f8bf47469b7bebb15a810de3827897326.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">invert_colors</span><span class="p">(</span><span class="n">grayscale</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17754191edd49e29ca6a4e2f59f00e94a5a5d2708f480b16cb3071cd36e23862.png" src="../_images/17754191edd49e29ca6a4e2f59f00e94a5a5d2708f480b16cb3071cd36e23862.png" />
</div>
</div>
</section>
</section>
<section id="sepia-filter">
<h2>Sepia Filter<a class="headerlink" href="#sepia-filter" title="Link to this heading">#</a></h2>
<p>This is similar to the Grayscale filter, but each new color channel gets a different combination of the original color channels. The constants used here are apparently recommended by Microsoft (though I can no longer find the source for this attribution).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">arr</span>
<span class="n">S_sepia</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">S_sepia</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.393</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.769</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.189</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">S_sepia</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.349</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.686</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.168</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">S_sepia</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.272</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.534</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.131</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">S_sepia</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/63163fafa436442b083edb4b5a49eb8db5c06beb2fef6c1df81408568cc528da.png" src="../_images/63163fafa436442b083edb4b5a49eb8db5c06beb2fef6c1df81408568cc528da.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_sepia</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(480, 480, 3)
</pre></div>
</div>
</div>
</div>
<p>We still need to stop any color channels from overflowing beyond 255</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sepia_filter</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
    <span class="n">S_sepia</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
    <span class="n">S_sepia</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.393</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.769</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.189</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">S_sepia</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.349</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.686</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.168</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">S_sepia</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.272</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.534</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.131</span><span class="o">*</span><span class="n">S</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="n">S_sepia</span><span class="p">[</span><span class="n">S_sepia</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">S_sepia</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">sepia_filter</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/caa5a8767357c2b6ba0c371e0e0452d0faa86063e77f0fea624a1b44d42cb923.png" src="../_images/caa5a8767357c2b6ba0c371e0e0452d0faa86063e77f0fea624a1b44d42cb923.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">invert_colors</span><span class="p">(</span><span class="n">sepia_filter</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4d8ff51fa2901e7cab0a35d3ef4bdc41a75b332d525aaf7f8cc3a3cb2a8fce07.png" src="../_images/4d8ff51fa2901e7cab0a35d3ef4bdc41a75b332d525aaf7f8cc3a3cb2a8fce07.png" />
</div>
</div>
</section>
<section id="gradient-filter">
<h2>Gradient filter<a class="headerlink" href="#gradient-filter" title="Link to this heading">#</a></h2>
<p>You can generalize the sepia filter by replacing the colors in your image with any other gradient or color map.</p>
<p>The code we‚Äôll follow bellow will be broken down into 3 big steps:</p>
<ul class="simple">
<li><p>Generate a gradient</p></li>
<li><p>Convert your image to grayscale</p></li>
<li><p>Replace the gray colors with your gradient color.</p></li>
</ul>
<section id="duotone-filter-generate-a-two-color-gradient-and-use-it-to-recolor-your-image">
<h3>Duotone filter - Generate a two-color gradient and use it to recolor your image<a class="headerlink" href="#duotone-filter-generate-a-two-color-gradient-and-use-it-to-recolor-your-image" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">duotone_gradient</span><span class="p">(</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">):</span>
    <span class="n">Duo_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">Duo_gradient</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">color1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">256</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">Duo_gradient</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Theme: Creamsicle</span>
<span class="n">color1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">]</span>  <span class="c1">#white </span>
<span class="n">color2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">240</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>   <span class="c1">#orange</span>

<span class="n">Creamsicle_gradient</span> <span class="o">=</span> <span class="n">duotone_gradient</span><span class="p">(</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Creamsicle_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">256</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="n">Grad_view</span> <span class="o">=</span> <span class="n">Creamsicle_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Grad_view</span><span class="p">))</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Expander</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="n">big_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">big_grad</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">Grad_view</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">],</span> <span class="n">Expander</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">big_grad</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4d816994e6adcfc61188b6ffd97c8eb553d263a13e9ef17149657a613883252b.png" src="../_images/4d816994e6adcfc61188b6ffd97c8eb553d263a13e9ef17149657a613883252b.png" />
<img alt="../_images/32a94b4ac38a44ec0e8cf96a633d547b70d28bcba78e2a70b5fcbe9c00e28b59.png" src="../_images/32a94b4ac38a44ec0e8cf96a633d547b70d28bcba78e2a70b5fcbe9c00e28b59.png" />
<img alt="../_images/37ae27d2fdccc8bb665c79e1cae537c7cccb165f272b0fbdbd29bd3917586ecf.png" src="../_images/37ae27d2fdccc8bb665c79e1cae537c7cccb165f272b0fbdbd29bd3917586ecf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">D_gray</span> <span class="o">=</span> <span class="n">grayscale</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="n">D_gray</span> <span class="o">=</span> <span class="n">D_gray</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">D</span><span class="p">[:,:,:]</span> <span class="o">=</span> <span class="n">D_gray</span>
<span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(480, 480, 3)
</pre></div>
</div>
<img alt="../_images/591f928100e286cf9dbc4635a22367332b0a55c66f03b15921f5b0dcf9484fcd.png" src="../_images/591f928100e286cf9dbc4635a22367332b0a55c66f03b15921f5b0dcf9484fcd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">gradient</span><span class="p">):</span>
    <span class="n">Du</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">D_gray</span> <span class="o">=</span> <span class="n">grayscale</span><span class="p">(</span><span class="n">Du</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">Mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">D_gray</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Du</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">Du</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">Mask</span><span class="p">[(</span><span class="n">Mask</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">Du</span><span class="p">[:,:,</span><span class="n">channel</span><span class="p">]</span> <span class="o">==</span> <span class="n">color</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1">#flags any channel that matches the color in that channel</span>
            <span class="n">Du</span><span class="p">[:,:,</span><span class="n">channel</span><span class="p">][(</span><span class="n">Du</span><span class="p">[:,:,</span><span class="n">channel</span><span class="p">]</span> <span class="o">==</span> <span class="n">color</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">Mask</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">[</span><span class="n">color</span><span class="p">,</span><span class="n">channel</span><span class="p">]</span>  <span class="c1">#changes the colors according to which channels are flagged.</span>
            <span class="n">Mask</span><span class="p">[</span><span class="n">Mask</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#Mark these channels as no longer needing to be changed.</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">Du</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Creamsicle_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">Creamsicle_gradient</span><span class="p">)</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Creamsicle_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6684f39c11cbd69254ea5af057049a1ac84485fa8a981628cded0ab652a1841b.png" src="../_images/6684f39c11cbd69254ea5af057049a1ac84485fa8a981628cded0ab652a1841b.png" />
</div>
</div>
<p>Try some of the other color choices below, or pick any two colors you want with the help of <a href="https://www.google.com/search?q=rgb+color+picker"> rgb color picker </a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Theme: Pumpkin</span>
<span class="n">color1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#black      </span>
<span class="n">color2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">240</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#orange</span>

<span class="n">Pumpkin_gradient</span> <span class="o">=</span> <span class="n">duotone_gradient</span><span class="p">(</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Pumpkin_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="n">Pumpkin_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">Pumpkin_gradient</span><span class="p">)</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Pumpkin_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/45d1b1c7928f9b739e3cea2c3ebabfb20db6b2f835a42e88931b101372f8a064.png" src="../_images/45d1b1c7928f9b739e3cea2c3ebabfb20db6b2f835a42e88931b101372f8a064.png" />
<img alt="../_images/1261008edef93803e0cc4edbc8ef9d2be0c3aa160c5248944f3d2aedb60109bd.png" src="../_images/1261008edef93803e0cc4edbc8ef9d2be0c3aa160c5248944f3d2aedb60109bd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Theme: UCI</span>
<span class="n">color1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">254</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="c1">#gold, from https://brand.uci.edu/identity/colors.php</span>
<span class="n">color2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">255</span><span class="p">]</span> <span class="c1">#blue, used above link as a reference, then went brighter, more saturated</span>

<span class="n">UCI_gradient</span> <span class="o">=</span> <span class="n">duotone_gradient</span><span class="p">(</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">UCI_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="n">UCI_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">UCI_gradient</span><span class="p">)</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">UCI_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/26b8d68b1181f80fe38652d46b7e216e9ee35bb35490de4c1b9f635e5c63334b.png" src="../_images/26b8d68b1181f80fe38652d46b7e216e9ee35bb35490de4c1b9f635e5c63334b.png" />
<img alt="../_images/fcb7a10f61d780bd91791fe867e22993c31bc4c6c01c27673700ea99f77cd357.png" src="../_images/fcb7a10f61d780bd91791fe867e22993c31bc4c6c01c27673700ea99f77cd357.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Theme: ADA Family</span>
<span class="n">color1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">139</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">26</span><span class="p">]</span>  
<span class="n">color2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">143</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">109</span><span class="p">]</span>

<span class="n">your_gradient</span> <span class="o">=</span> <span class="n">duotone_gradient</span><span class="p">(</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">your_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="n">your_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">your_gradient</span><span class="p">)</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">your_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2937525d16e7480e0e848def625154d5841794517ce5911fd6ca874ff170ac19.png" src="../_images/2937525d16e7480e0e848def625154d5841794517ce5911fd6ca874ff170ac19.png" />
<img alt="../_images/919b918ce7b5230f91bc036aa3aff71e36031cf36cd9aa314a20fa424f8da059.png" src="../_images/919b918ce7b5230f91bc036aa3aff71e36031cf36cd9aa314a20fa424f8da059.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Theme: Pick your own colors, all you need are the RGB values: https://www.google.com/search?q=rgb+color+picker</span>
<span class="n">color1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>  
<span class="n">color2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">220</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">your_gradient</span> <span class="o">=</span> <span class="n">duotone_gradient</span><span class="p">(</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">your_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="n">your_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">your_gradient</span><span class="p">)</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">your_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a28642a6fa6fab7acd7a25793d556b76b64ad7057c6fcae717e5885ce1cb6b5e.png" src="../_images/a28642a6fa6fab7acd7a25793d556b76b64ad7057c6fcae717e5885ce1cb6b5e.png" />
<img alt="../_images/b7289798bb09215e919b5cbeacf6314c65a5f09902d1f0368ed6479998e649dd.png" src="../_images/b7289798bb09215e919b5cbeacf6314c65a5f09902d1f0368ed6479998e649dd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Theme: Pick your own colors, all you need are the RGB values: https://www.google.com/search?q=rgb+color+picker</span>
<span class="n">color1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">179</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>  
<span class="n">color2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">84</span><span class="p">]</span>

<span class="n">your_gradient</span> <span class="o">=</span> <span class="n">duotone_gradient</span><span class="p">(</span><span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">invert_colors</span><span class="p">(</span><span class="n">your_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">))))</span>

<span class="n">your_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">invert_colors</span><span class="p">(</span><span class="n">your_gradient</span><span class="p">))</span>

<span class="n">final_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">your_filter</span><span class="p">)</span>
<span class="n">final_image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;our_art.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/df65fc73b67794d860259bffdbc58cd4306825cebd7e4b5fec564a8f9df33be9.png" src="../_images/df65fc73b67794d860259bffdbc58cd4306825cebd7e4b5fec564a8f9df33be9.png" />
</div>
</div>
</section>
<section id="other-gradients-and-other-color-replacement">
<h3>Other gradients, and other color replacement<a class="headerlink" href="#other-gradients-and-other-color-replacement" title="Link to this heading">#</a></h3>
<p>There‚Äôs nothing special about using duotone gradients in the filter above. You can use any other gradient, or any other array of 256 values to determine your image colors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rainbow_colors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">130</span><span class="p">],</span>   <span class="c1"># Indigo        </span>
        <span class="p">[</span><span class="mi">148</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">211</span><span class="p">],</span>   <span class="c1"># Violet</span>
        <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># Red</span>
        <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Orange</span>
        <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Yellow</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># Green</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">]</span>    <span class="c1"># Blue</span>
    <span class="p">]</span>

<span class="n">rainbow_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">258</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1">#43*6 = 258. Needed because 43 does not divide evenly into 256, but it divides evenly into 258</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rainbow_gradient</span><span class="p">[</span><span class="mi">43</span><span class="o">*</span><span class="n">h</span><span class="p">:</span><span class="mi">43</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">rainbow_colors</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">rainbow_colors</span><span class="p">[</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">43</span><span class="p">)</span>  <span class="c1">#43*6 = 258</span>

<span class="n">rainbow_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">rainbow_gradient</span><span class="p">[:</span><span class="mi">256</span><span class="p">])</span> <span class="c1">#clip the extra two colors from the end of this image, to get 256 colors and not 258.</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">rainbow_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="n">rainbow_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">rainbow_gradient</span><span class="p">)</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">rainbow_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/eaaa2915119f3061d573a3e4e3db667bb38d9d41dd777e1a81a51ecfba834d6c.png" src="../_images/eaaa2915119f3061d573a3e4e3db667bb38d9d41dd777e1a81a51ecfba834d6c.png" />
<img alt="../_images/f3f0ff99822e2722026700fd9f12b23032b79b06eaea0ebbea0bf777c62eb6c7.png" src="../_images/f3f0ff99822e2722026700fd9f12b23032b79b06eaea0ebbea0bf777c62eb6c7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rainbow_colors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>    <span class="c1"># Blue</span>
        <span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">130</span><span class="p">],</span>   <span class="c1"># Indigo        </span>
        <span class="p">[</span><span class="mi">148</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">211</span><span class="p">],</span>   <span class="c1"># Violet</span>
        <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># Red</span>
        <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Orange</span>
        <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Yellow</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># Green</span>
    <span class="p">]</span>

<span class="n">rainbow_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">258</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1">#43*6 = 258. Needed because 43 does not divide evenly into 256, but it divides evenly into 258</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rainbow_gradient</span><span class="p">[</span><span class="mi">43</span><span class="o">*</span><span class="n">h</span><span class="p">:</span><span class="mi">43</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">rainbow_colors</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">rainbow_colors</span><span class="p">[</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">43</span><span class="p">)</span>  <span class="c1">#43*6 = 258</span>

<span class="n">rainbow_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">rainbow_gradient</span><span class="p">[:</span><span class="mi">256</span><span class="p">])</span> <span class="c1">#clip the extra two colors from the end of this image, to get 256 colors and not 258.</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">rainbow_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="n">rainbow_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">rainbow_gradient</span><span class="p">)</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">rainbow_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ae5e5fd8e8b403200a70231f1a64f8d9d5b8ae19f17790e52a6de6c4d606d52f.png" src="../_images/ae5e5fd8e8b403200a70231f1a64f8d9d5b8ae19f17790e52a6de6c4d606d52f.png" />
<img alt="../_images/1f1d0fd774485348fca1c5250710f75b9eb0bc2b3ce4ce735f0d4e1c0d5e3637.png" src="../_images/1f1d0fd774485348fca1c5250710f75b9eb0bc2b3ce4ce735f0d4e1c0d5e3637.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rainbow_transpose_gradient</span> <span class="o">=</span> <span class="n">rainbow_gradient</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">rainbow_transpose_gradient</span><span class="p">))</span>

<span class="n">rainbow_transpose_gradient</span> <span class="o">=</span> <span class="n">rainbow_transpose_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="n">rainbow_transpose_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">rainbow_transpose_gradient</span><span class="p">)</span>

<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">rainbow_transpose_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/98d3c0a020f7d278366c6a3c8ec7ac6fbd57b534ea2926ee483c7bf632865892.png" src="../_images/98d3c0a020f7d278366c6a3c8ec7ac6fbd57b534ea2926ee483c7bf632865892.png" />
<img alt="../_images/ad1c3dcca8e1e01ff8f44fb930af4fc3dc583017a7d143e5adbb52558d82a13a.png" src="../_images/ad1c3dcca8e1e01ff8f44fb930af4fc3dc583017a7d143e5adbb52558d82a13a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Creamsicle_gradient</span><span class="p">[:</span><span class="mi">144</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Creamsicle_gradient</span><span class="p">[</span><span class="mi">144</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">,::]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8a948bcacb33e40b006804a699db211d7e957de7a84e9340299387a7c2703b6e.png" src="../_images/8a948bcacb33e40b006804a699db211d7e957de7a84e9340299387a7c2703b6e.png" />
<img alt="../_images/74ddb53d83d3164b2504fa687c1281d413867f73695d76aa6f55ad841ae24580.png" src="../_images/74ddb53d83d3164b2504fa687c1281d413867f73695d76aa6f55ad841ae24580.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">Combo_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">Creamsicle_gradient</span><span class="p">[:</span><span class="n">split</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Creamsicle_gradient</span><span class="p">[</span><span class="n">split</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">,::]))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Combo_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
    <span class="n">Combo_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">Combo_gradient</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">Combo_filter</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/416eea9b0d0dce34cc82c4197182de97a3549a35d5fca82986f90ade392f855e.png" src="../_images/416eea9b0d0dce34cc82c4197182de97a3549a35d5fca82986f90ade392f855e.png" />
<img alt="../_images/f256abd5ae172919db73caba02781d8303eaa11a4713bb8ef73be09265a99202.png" src="../_images/f256abd5ae172919db73caba02781d8303eaa11a4713bb8ef73be09265a99202.png" />
<img alt="../_images/1ed72e27f4597bb837655b57600450ded7651ba09ab05341a63c82bba804b65b.png" src="../_images/1ed72e27f4597bb837655b57600450ded7651ba09ab05341a63c82bba804b65b.png" />
<img alt="../_images/bf93b661a0ecb06e16f1681e6117d7cd5a29314a3816d7bcf2c7c814e8e25334.png" src="../_images/bf93b661a0ecb06e16f1681e6117d7cd5a29314a3816d7bcf2c7c814e8e25334.png" />
<img alt="../_images/3eaf31f4e042264e968d66d7321308542e494babd33b9a8499deabb3882f5022.png" src="../_images/3eaf31f4e042264e968d66d7321308542e494babd33b9a8499deabb3882f5022.png" />
<img alt="../_images/15a97e1e7a6de8f6e617fc36e0006c5ae445183025141a9f023e98347cb1d452.png" src="../_images/15a97e1e7a6de8f6e617fc36e0006c5ae445183025141a9f023e98347cb1d452.png" />
<img alt="../_images/0bed99eb6e0dc1ecea02d3aaecb3d9330ff513aa2b7060412cb0c098f378f959.png" src="../_images/0bed99eb6e0dc1ecea02d3aaecb3d9330ff513aa2b7060412cb0c098f378f959.png" />
<img alt="../_images/626b98bed17478622a99a32fd34794379a6ed30718000e4ba387cf08bdae3a68.png" src="../_images/626b98bed17478622a99a32fd34794379a6ed30718000e4ba387cf08bdae3a68.png" />
<img alt="../_images/2b690a8fa2a441cc441c98ef76c52380fa4c591bd41eebdeaea63927d68e3874.png" src="../_images/2b690a8fa2a441cc441c98ef76c52380fa4c591bd41eebdeaea63927d68e3874.png" />
<img alt="../_images/1614f07641b7c2c35ef826b687163cdab60a3ce6062f5169cf8b6250da1b0817.png" src="../_images/1614f07641b7c2c35ef826b687163cdab60a3ce6062f5169cf8b6250da1b0817.png" />
<img alt="../_images/879ea8990f94149fff75bfaafd08679ec1535c22b2d78ff9755f4513321053b9.png" src="../_images/879ea8990f94149fff75bfaafd08679ec1535c22b2d78ff9755f4513321053b9.png" />
<img alt="../_images/bc862643cee0f9805215cc578fec00ecb2c0578eb5d3b7e686c736f7cca09dbf.png" src="../_images/bc862643cee0f9805215cc578fec00ecb2c0578eb5d3b7e686c736f7cca09dbf.png" />
<img alt="../_images/d7716217d341e7a6bee5b392b2e78fa4d0ea592357d8e3ac0bdd18ad84e5e3be.png" src="../_images/d7716217d341e7a6bee5b392b2e78fa4d0ea592357d8e3ac0bdd18ad84e5e3be.png" />
<img alt="../_images/270be594fdeb4d2bc45a49fa1aaa95340c2057961855302ce4c97cdee398093e.png" src="../_images/270be594fdeb4d2bc45a49fa1aaa95340c2057961855302ce4c97cdee398093e.png" />
<img alt="../_images/1e8e5134618fb2c2747eeee7b54ad60aca1b83ae20e173b4b08e7800467865af.png" src="../_images/1e8e5134618fb2c2747eeee7b54ad60aca1b83ae20e173b4b08e7800467865af.png" />
<img alt="../_images/002af3660c64576792c2ce21450f2d2006ebc4dc8b2e135059b276b4b9d1c0f6.png" src="../_images/002af3660c64576792c2ce21450f2d2006ebc4dc8b2e135059b276b4b9d1c0f6.png" />
<img alt="../_images/2b587ce9f5dd7597b7beeb2095c007e732342415fd0befa0904e92198c124383.png" src="../_images/2b587ce9f5dd7597b7beeb2095c007e732342415fd0befa0904e92198c124383.png" />
<img alt="../_images/0ebcaa2aa8583d129c2189e511dacd2f84d709abe538f1b52038dd24f4a2d60f.png" src="../_images/0ebcaa2aa8583d129c2189e511dacd2f84d709abe538f1b52038dd24f4a2d60f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">custom_gradient_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Custom gradient.png&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">custom_gradient_image</span><span class="p">)</span>
<span class="n">custom_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">custom_gradient_image</span><span class="p">)</span>  <span class="c1">#for some reason, this image has 4 channels, rgba, with &quot;a&quot; standing for &quot;alpha&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">custom_gradient</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">custom_gradient</span> <span class="o">=</span> <span class="n">custom_gradient</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">custom_gradient</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">custom_filter</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">custom_gradient</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">custom_filter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/90ca8f940db1892f20bbeb5d3e018a2b462747504e319efda6c97c4f6dc5b3c5.png" src="../_images/90ca8f940db1892f20bbeb5d3e018a2b462747504e319efda6c97c4f6dc5b3c5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(16, 16, 4)
(16, 16, 3)
</pre></div>
</div>
<img alt="../_images/615ab5e5d612ee2d101112679eb8035ae6e56201f35767b869798f7334885578.png" src="../_images/615ab5e5d612ee2d101112679eb8035ae6e56201f35767b869798f7334885578.png" />
</div>
</div>
</section>
</section>
<section id="white-noise-colorful-noise">
<h2>White Noise, Colorful Noise<a class="headerlink" href="#white-noise-colorful-noise" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,[</span><span class="mi">100</span><span class="p">,</span><span class="mi">700</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">R</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e3b2d46a72a02d6075d458acf82a865132a682d39e0ac00c183f197a4cc4940a.png" src="../_images/e3b2d46a72a02d6075d458acf82a865132a682d39e0ac00c183f197a4cc4940a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R_color</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,[</span><span class="mi">100</span><span class="p">,</span><span class="mi">700</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">R_color</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c3c036a9d9e87f258cd29695033ea7c76351a83315275a25e5e2707c0ec32da6.png" src="../_images/c3c036a9d9e87f258cd29695033ea7c76351a83315275a25e5e2707c0ec32da6.png" />
</div>
</div>
<p>We can blend noise into our images by taking a weighted average our image and a noise image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;ash-lake.png&quot;</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

<span class="n">weighted_average</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">weight</span><span class="p">,</span> <span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">weight</span><span class="p">)</span><span class="o">*</span><span class="n">arr1</span> <span class="o">+</span> <span class="n">weight</span><span class="o">*</span><span class="n">arr2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">invert_colors</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">B</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">-</span> <span class="n">B</span>
    <span class="k">return</span> <span class="n">B</span>

<span class="k">def</span> <span class="nf">channel_swap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">swap</span><span class="p">):</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">B</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="n">swap</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">B</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="n">swap</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">B</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,:,</span><span class="n">swap</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">B</span>

<span class="k">def</span> <span class="nf">adjust_lighting</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">L</span>
    <span class="n">L</span><span class="p">[</span><span class="n">L</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

<span class="n">B_rb_inv</span> <span class="o">=</span> <span class="n">invert_colors</span><span class="p">(</span><span class="n">channel_swap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,(</span><span class="mi">480</span><span class="p">,</span><span class="mi">480</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">weighted_average</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">B_rb_inv</span><span class="p">,</span> <span class="n">R2</span><span class="p">)</span>  <span class="c1">#Weight the two images together, like in the example earlier in this notebook.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f4c6a168598e64ece10726e4a18f4ec3dce1a56a9e8a9ad7c5f26b76eed823b7.png" src="../_images/f4c6a168598e64ece10726e4a18f4ec3dce1a56a9e8a9ad7c5f26b76eed823b7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R_color2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1">#get the size of the random array from the image array</span>
<span class="n">weighted_average</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">B_rb_inv</span><span class="p">,</span> <span class="n">R_color2</span><span class="p">)</span> <span class="c1">#Weight the two images together, like in the example earlier in this notebook.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7c42b616db6327087a7a237ebca0418b96629a7cf63025786a029e0fb653b7d8.png" src="../_images/7c42b616db6327087a7a237ebca0418b96629a7cf63025786a029e0fb653b7d8.png" />
</div>
</div>
<section id="more-blending-modes">
<h3>More blending modes<a class="headerlink" href="#more-blending-modes" title="Link to this heading">#</a></h3>
<p>These blend modes are found in common photo editing software. Reference: <a href= "https://en.wikipedia.org/wiki/Blend_modes"> Blend modes - Wikipedia </a></p>
<section id="lighten-only">
<h4>Lighten Only:<a class="headerlink" href="#lighten-only" title="Link to this heading">#</a></h4>
<p>Across each individual pixel and color channel, take the maximum. Brighter colors have higher numbers</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lighten_only</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)))</span>
<span class="c1">#Note: np.maximum is different from np.max!</span>
<span class="c1">#np.maximum compares 2 arrays component-wise and returns the largest values</span>
<span class="c1">#np.max finds the single largest element in one array (or along an axis, depending on your inputs)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">lighten_only</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span> <span class="n">B_rb_inv</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">lighten_only</span><span class="p">(</span><span class="n">R_color2</span><span class="p">,</span> <span class="n">B_rb_inv</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/917e2b68605e768d5c0ae4a19bcd5cb33de5497c650d1adbc03cfcb768c66089.png" src="../_images/917e2b68605e768d5c0ae4a19bcd5cb33de5497c650d1adbc03cfcb768c66089.png" />
<img alt="../_images/273b2b6d82428d4ad3751399407632fcaa7b3fc672be958f91f4203f04b65e72.png" src="../_images/273b2b6d82428d4ad3751399407632fcaa7b3fc672be958f91f4203f04b65e72.png" />
</div>
</div>
</section>
<section id="darken-only">
<h4>Darken Only:<a class="headerlink" href="#darken-only" title="Link to this heading">#</a></h4>
<p>Across each individual pixel and color channel, take the minimum. Darker colors have smaller numbers</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">darken_only</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)))</span>
<span class="c1">#Similarly, np.minimum is different from np.min!</span>
<span class="c1">#np.minimum compares 2 arrays component-wise and returns the smallest values</span>
<span class="c1">#np.min finds the single smallest element in one array (or along an axis, depending on your inputs)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">darken_only</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span> <span class="n">B_rb_inv</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">darken_only</span><span class="p">(</span><span class="n">R_color2</span><span class="p">,</span> <span class="n">B_rb_inv</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f5d6d41f37ec0a323a7ff478f0907b9f2676d84334e3cdf3d9e1363225a2b486.png" src="../_images/f5d6d41f37ec0a323a7ff478f0907b9f2676d84334e3cdf3d9e1363225a2b486.png" />
<img alt="../_images/83ac13b4acfb063ba6b00bc0e83bc41449230f96e08e89ce633779309cbcfa1f.png" src="../_images/83ac13b4acfb063ba6b00bc0e83bc41449230f96e08e89ce633779309cbcfa1f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;images&quot;</span><span class="p">,</span><span class="s1">&#39;Cloud.png&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">arr_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">480</span><span class="p">,</span><span class="mi">480</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">arr_c</span><span class="p">[:,:,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span><span class="mi">480</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>images\Cloud.png
</pre></div>
</div>
<img alt="../_images/c77c16029284351222897766809c3f0111e71d34575fca761fec5f7a82a0bd85.png" src="../_images/c77c16029284351222897766809c3f0111e71d34575fca761fec5f7a82a0bd85.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">darken_only</span><span class="p">(</span><span class="n">adjust_lighting</span><span class="p">(</span><span class="n">arr_c</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">B_rb_inv</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">darken_only</span><span class="p">(</span><span class="n">adjust_lighting</span><span class="p">(</span><span class="n">arr_c</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sepia_filter</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/26786791212807e99b2a680f8ac54a4c98170347734cd872b0344fe811e258de.png" src="../_images/26786791212807e99b2a680f8ac54a4c98170347734cd872b0344fe811e258de.png" />
<img alt="../_images/73cc91daf2ed990f580a78099abb9d170b595be3c029ca87a2a448eead1cb45e.png" src="../_images/73cc91daf2ed990f580a78099abb9d170b595be3c029ca87a2a448eead1cb45e.png" />
</div>
</div>
</section>
<section id="absolute-difference">
<h4>(Absolute) Difference:<a class="headerlink" href="#absolute-difference" title="Link to this heading">#</a></h4>
<p>Subtract one image from the other, and then take the absolute value</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abs_diff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">arr2</span><span class="p">))))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">abs_diff</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">,</span> <span class="n">weight</span><span class="o">*</span><span class="n">arr_c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a852f3e2c23d27f2a3e8354b38fd955983d61afb62810803adf185ff0b2b706a.png" src="../_images/a852f3e2c23d27f2a3e8354b38fd955983d61afb62810803adf185ff0b2b706a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">display</span><span class="p">((</span><span class="n">abs_diff</span><span class="p">(</span><span class="n">adjust_lighting</span><span class="p">(</span><span class="n">arr_c</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">invert_colors</span><span class="p">(</span><span class="n">sepia_filter</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a96ad6b76d1df871d03f28593b034f9dc7ba047f06d5ae62195178748ee36e58.png" src="../_images/a96ad6b76d1df871d03f28593b034f9dc7ba047f06d5ae62195178748ee36e58.png" />
</div>
</div>
</section>
<section id="color-dodge">
<h4>Color Dodge:<a class="headerlink" href="#color-dodge" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">color_dodge</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">):</span>
    <span class="n">arr_cd</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">arr1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">255</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">arr2</span><span class="p">))</span>
    <span class="n">arr_cd</span><span class="p">[</span><span class="n">arr_cd</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="n">arr_cd</span><span class="p">[</span><span class="n">arr_cd</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">arr_cd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1">#lower the intensity of the noise</span>
<span class="n">B_cd</span> <span class="o">=</span> <span class="n">color_dodge</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">,</span> <span class="n">weight</span><span class="o">*</span><span class="n">R_color2</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_cd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/172d2bd48fd0132153717af94334f6ae2e976b5d2d5e31c5ed134161a019b7fd.png" src="../_images/172d2bd48fd0132153717af94334f6ae2e976b5d2d5e31c5ed134161a019b7fd.png" />
</div>
</div>
</section>
<section id="color-burn">
<h4>Color Burn:<a class="headerlink" href="#color-burn" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">color_burn</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span><span class="n">arr2</span><span class="p">):</span>
    <span class="n">arr_cb</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span> <span class="p">(</span><span class="mi">255</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">arr1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">arr2</span><span class="p">))</span>
    <span class="n">arr_cb</span> <span class="o">*=</span> <span class="mi">255</span>
    <span class="n">arr_cb</span><span class="p">[</span><span class="n">arr_cb</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="n">arr_cb</span><span class="p">[</span><span class="n">arr_cb</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">arr_cb</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="c1">#lower the intensity of the noise</span>
<span class="n">B_cb</span> <span class="o">=</span> <span class="n">color_burn</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">,</span> <span class="n">weight</span><span class="o">*</span><span class="n">R_color2</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_cb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\lukea\AppData\Local\Temp\ipykernel_11724\4237971857.py:2: RuntimeWarning: divide by zero encountered in divide
  arr_cb = 1- (255 - np.float64(arr1))/(np.float64(arr2))
C:\Users\lukea\AppData\Local\Temp\ipykernel_11724\4237971857.py:2: RuntimeWarning: invalid value encountered in divide
  arr_cb = 1- (255 - np.float64(arr1))/(np.float64(arr2))
C:\Users\lukea\AppData\Local\Temp\ipykernel_11724\4237971857.py:6: RuntimeWarning: invalid value encountered in cast
  return np.uint8(arr_cb)
</pre></div>
</div>
<img alt="../_images/8a1a5cd9164f6bd97cb5bf72ac715acba8cbd79f511eccb58d99a7714d115910.png" src="../_images/8a1a5cd9164f6bd97cb5bf72ac715acba8cbd79f511eccb58d99a7714d115910.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="mf">1.25</span>
<span class="n">B_cb2</span> <span class="o">=</span> <span class="n">color_burn</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">,</span> <span class="n">weight</span><span class="o">*</span><span class="n">arr_c</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">B_cb2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\lukea\AppData\Local\Temp\ipykernel_11724\4237971857.py:2: RuntimeWarning: divide by zero encountered in divide
  arr_cb = 1- (255 - np.float64(arr1))/(np.float64(arr2))
C:\Users\lukea\AppData\Local\Temp\ipykernel_11724\4237971857.py:2: RuntimeWarning: invalid value encountered in divide
  arr_cb = 1- (255 - np.float64(arr1))/(np.float64(arr2))
C:\Users\lukea\AppData\Local\Temp\ipykernel_11724\4237971857.py:6: RuntimeWarning: invalid value encountered in cast
  return np.uint8(arr_cb)
</pre></div>
</div>
<img alt="../_images/12d012e8b77d21183e8ca3050394cf33dde37da16ab12604d2e744a221471280.png" src="../_images/12d012e8b77d21183e8ca3050394cf33dde37da16ab12604d2e744a221471280.png" />
</div>
</div>
</section>
</section>
<section id="combine-gradient-filters-with-blend-modes">
<h3>Combine gradient filters with blend modes<a class="headerlink" href="#combine-gradient-filters-with-blend-modes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R_creamsicle</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">R_color2</span><span class="p">),</span> <span class="n">Creamsicle_gradient</span><span class="p">)</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">R_creamsicle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5998a49329342bc0e13ad6a24287691405067571d3e689512b6530c58c28209b.png" src="../_images/5998a49329342bc0e13ad6a24287691405067571d3e689512b6530c58c28209b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">darken_only</span><span class="p">(</span><span class="n">R_creamsicle</span><span class="p">,</span> <span class="n">B_rb_inv</span><span class="p">))</span>

<span class="n">weight</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="n">display</span><span class="p">(</span><span class="n">abs_diff</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">,</span> <span class="n">weight</span><span class="o">*</span><span class="n">R_creamsicle</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e8d0b9ec23aa07efb6fa87eeba0666d83931078b1b5a6904fbcc5805c2e9c7e2.png" src="../_images/e8d0b9ec23aa07efb6fa87eeba0666d83931078b1b5a6904fbcc5805c2e9c7e2.png" />
<img alt="../_images/7e48e94b21a28f23f0a48d1d59b97c32c6557bce0e6afbb79f1105aac4f6b75a.png" src="../_images/7e48e94b21a28f23f0a48d1d59b97c32c6557bce0e6afbb79f1105aac4f6b75a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">color_burn</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">R_creamsicle</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1ae4953527aedd1eec2f97e96a23727bb159f43929fbb3796594e4f71f1204ad.png" src="../_images/1ae4953527aedd1eec2f97e96a23727bb159f43929fbb3796594e4f71f1204ad.png" />
<img alt="../_images/c9e57938bdf736e5e3b9c8fb233d5551672fb24a3e7026e8baac1c6df12c85d0.png" src="../_images/c9e57938bdf736e5e3b9c8fb233d5551672fb24a3e7026e8baac1c6df12c85d0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_c_creamsicle</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">arr_c</span><span class="p">),</span> <span class="n">Creamsicle_gradient</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_c_creamsicle</span><span class="p">))</span>
<span class="n">arr_c_UCI</span> <span class="o">=</span> <span class="n">gradient_filter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">arr_c</span><span class="p">),</span> <span class="n">UCI_gradient</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr_c_UCI</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f49f67707c29adc1f4f2daa02ed0b79f4b5b1ff797e6f491da01d2bd3b60d6ea.png" src="../_images/f49f67707c29adc1f4f2daa02ed0b79f4b5b1ff797e6f491da01d2bd3b60d6ea.png" />
<img alt="../_images/94e5fabfa3c410ff7b150940381247ce6be7b9928075acfefc60f832ecb2b460.png" src="../_images/94e5fabfa3c410ff7b150940381247ce6be7b9928075acfefc60f832ecb2b460.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">abs_diff</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">,</span> <span class="mf">0.66</span><span class="o">*</span><span class="n">arr_c_creamsicle</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">abs_diff</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">,</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">arr_c_UCI</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/983be9d091a5d051dc0001379ffbcc31b945c0203fc6c6320c3f3c9a9d5486a3.png" src="../_images/983be9d091a5d051dc0001379ffbcc31b945c0203fc6c6320c3f3c9a9d5486a3.png" />
<img alt="../_images/13a51d79d6f43f41dc0d4603aa810942ebfa444ec1b120fbd9fe651dbc23a6cb.png" src="../_images/13a51d79d6f43f41dc0d4603aa810942ebfa444ec1b120fbd9fe651dbc23a6cb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>

<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">color_burn</span><span class="p">(</span><span class="n">B_rb_inv</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">arr_c_creamsicle</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b1e43e04c72861dbcb1893d468130003d5e2efe5c473e6ff7d7cbd14e6e9e1e4.png" src="../_images/b1e43e04c72861dbcb1893d468130003d5e2efe5c473e6ff7d7cbd14e6e9e1e4.png" />
<img alt="../_images/fb0de20a3e9116c3cfac06d2e40db1d40030db83bb935232c1d1a411c2d25342.png" src="../_images/fb0de20a3e9116c3cfac06d2e40db1d40030db83bb935232c1d1a411c2d25342.png" />
</div>
</div>
</section>
</section>
<section id="more-photo-manipulation-effects">
<h2>More photo manipulation effects<a class="headerlink" href="#more-photo-manipulation-effects" title="Link to this heading">#</a></h2>
<p>Many photo manipulation and image generation effects can be readily broadcast across the array of an image, pixel-by-pixel. Some of the above techniques are used directly by Photoshop.</p>
<p>Many more techniques rely on the pixels surrounding the individual pixel, such as blurring an image, sharpening an image, or edge detection. <a href = https://github.com/smithla-math/UCI_MATH_10/blob/master/homework/Homework4/homework_4.ipynb> Hints for these ideas can be found in Math 10 (an old Summer 2022 homework assignment) </a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lec25_27_FA_25.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lectures 25-27</p>
      </div>
    </a>
    <a class="right-next"
       href="../homework/pyhw3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Python Homework #3</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-newton-s-method">Analyzing Newton‚Äôs Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newton-s-method-vs-bisect-method-timing-and-tradeoffs">Newton‚Äôs Method vs. Bisect Method: Timing and Tradeoffs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-processing">Image Processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-an-image">Opening an image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-arrays-and-images">NumPy Arrays and Images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#blending-images">Blending Images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#averaging-images-in-2d-video-game-graphics-transparent-water">Averaging images in 2D video game graphics: Transparent water</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-colors">Setting Colors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-an-image-from-scratch">Making an image from scratch</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#swapping-color-channels">Swapping color channels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#invert-colors">Invert Colors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#threshold-filter">Threshold filter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brighten-darken-image">Brighten/Darken Image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grayscale-filter">Grayscale Filter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-better-algorithm-for-grayscale">A better algorithm for grayscale</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sepia-filter">Sepia Filter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient-filter">Gradient filter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#duotone-filter-generate-a-two-color-gradient-and-use-it-to-recolor-your-image">Duotone filter - Generate a two-color gradient and use it to recolor your image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-gradients-and-other-color-replacement">Other gradients, and other color replacement</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#white-noise-colorful-noise">White Noise, Colorful Noise</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-blending-modes">More blending modes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lighten-only">Lighten Only:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#darken-only">Darken Only:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#absolute-difference">(Absolute) Difference:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#color-dodge">Color Dodge:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#color-burn">Color Burn:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combine-gradient-filters-with-blend-modes">Combine gradient filters with blend modes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-photo-manipulation-effects">More photo manipulation effects</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Christopher Davis, Yasmeen Baki, and Luke Smith
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>